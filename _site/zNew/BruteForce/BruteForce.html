<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/style.css?v=">

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pentest CheatSheet | Pentest CheatSheet</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Pentest CheatSheet" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Pentest CheatSheet" />
<meta property="og:description" content="Pentest CheatSheet" />
<link rel="canonical" href="http://localhost:4000/zNew/BruteForce/BruteForce.html" />
<meta property="og:url" content="http://localhost:4000/zNew/BruteForce/BruteForce.html" />
<meta property="og:site_name" content="Pentest CheatSheet" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pentest CheatSheet" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Pentest CheatSheet","headline":"Pentest CheatSheet","url":"http://localhost:4000/zNew/BruteForce/BruteForce.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>Pentest CheatSheet</h1>
        </a>
        <h2>Pentest CheatSheet</h2>

        <section id="downloads">
          
          <a href="" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="passwords-attack">Passwords Attack</h1>
<h2 id="hash-identifier">Hash Identifier</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hash-identifier
</code></pre></div></div>

<h2 id="crack-password">Crack Password</h2>
<h3 id="john-the-ripper">John The Ripper</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>john pass.txt <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt<span class="sb">`</span>
</code></pre></div></div>

<h3 id="hashcat">Hashcat</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hashcat <span class="nt">-m</span> 3200 <span class="nt">-a</span> 0 <span class="nt">-o</span> found.txt passwd.txt /usr/share/wordlists/rockyou.txt

<span class="c"># 1000 NTLM hashes</span>
<span class="c"># 5600 NTLMv2 hashes</span>
<span class="c"># 13100 Kerberos TGS</span>
</code></pre></div></div>

<h2 id="password-mutations">Password Mutations</h2>
<p><code class="language-plaintext highlighter-rouge">/usr/share/hashcat/rules/</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hashcat <span class="nt">--force</span> password.list <span class="nt">-r</span> custom.rule <span class="nt">--stdout</span> | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> mut_password.list
</code></pre></div></div>

<hr />

<h1 id="custom-wordlists">Custom Wordlists</h1>
<h2 id="cewl">CeWL</h2>
<p>We can now use another tool called CeWL to scan potential words from the company’s website and save them in a separate list. We can then combine this list with the desired rules and create a customized password list that has a higher probability of guessing a correct password. We specify some parameters, like the depth to spider (-d), the minimum length of the word (-m), the storage of the found words in lowercase (–lowercase), as well as the file where we want to store the results (-w).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cewl https://www.inlanefreight.com <span class="nt">-d</span> 4 <span class="nt">-m</span> 6 <span class="nt">--lowercase</span> <span class="nt">-w</span> inlane.wordlist
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">-d minimum word length</code></li>
  <li><code class="language-plaintext highlighter-rouge">-m maximum word length</code></li>
  <li><code class="language-plaintext highlighter-rouge">--lowercase all words are lowercase</code></li>
  <li><code class="language-plaintext highlighter-rouge">-w output file</code></li>
</ul>

<h2 id="cupp">CUPP</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cupp <span class="nt">-i</span>

<span class="nb">sed</span> <span class="nt">-ri</span> <span class="s1">'/^.{,7}$/d'</span> william.txt            <span class="c"># remove shorter than 8</span>
<span class="nb">sed</span> <span class="nt">-ri</span> <span class="s1">'/[!-/:-@\[-`\{-~]+/!d'</span> william.txt <span class="c"># remove no special chars</span>
<span class="nb">sed</span> <span class="nt">-ri</span> <span class="s1">'/[0-9]+/!d'</span> william.txt            <span class="c"># remove no numbers</span>
</code></pre></div></div>

<h2 id="custom-list-of-usernames">Custom list of Usernames</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./username-anarchy <span class="nt">-i</span> /home/ltnbob/names.txt 
<span class="nv">$ </span>./username-anarchy Bill Gates <span class="o">&gt;</span> bill.txt
</code></pre></div></div>

<h2 id="default-passwords">Default Passwords</h2>
<p><strong>Credential Stuffing - Hydra</strong>
There are various databases that keep a running list of known default credentials. One of them is the (DefaultCreds-Cheat-Sheet)[https://github.com/ihebski/DefaultCreds-cheat-sheet]. Here is a small excerpt from the entire table of this cheat sheet:</p>

<p>This is a simplified variant of brute-forcing because only composite usernames and the associated passwords are used.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-C</span> &lt;user_pass.list&gt; &lt;protocol&gt;://&lt;IP&gt;
</code></pre></div></div>

<hr />

<h1 id="services">Services</h1>
<p><code class="language-plaintext highlighter-rouge">Note: Although we may find services vulnerable to brute force, most applications today prevent these types of attacks. A more effective method is Password Spraying.</code></p>

<h2 id="hydra">Hydra</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-L</span> user.list <span class="nt">-P</span> password.list &lt;protocol&gt;://&lt;IP&gt; <span class="nt">-t</span> 48 <span class="nt">-p</span> &lt;port&gt;

- L user list 
- l single username 
- P pass list
- p single password
- t &lt;num&gt; threads
- p &lt;port&gt;
</code></pre></div></div>

<h2 id="ftp">FTP</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>medusa <span class="nt">-u</span> fiona <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt <span class="nt">-h</span> 10.129.203.7 <span class="nt">-M</span> ftp 

<span class="nv">$ </span>hydra <span class="nt">-L</span> user.list <span class="nt">-P</span> password.list ftp://&lt;IP&gt; <span class="nt">-s</span> 21
</code></pre></div></div>

<h2 id="ssh">SSH</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-L</span> user.list <span class="nt">-P</span> password.list ssh://&lt;IP&gt;
</code></pre></div></div>

<h2 id="smb">SMB</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>crackmapexec smb 10.10.110.17 <span class="nt">-u</span> /tmp/userlist.txt <span class="nt">-p</span> <span class="s1">'Company01!'</span> <span class="nt">--local-auth</span>

<span class="nv">$ </span>hydra <span class="nt">-L</span> user.list <span class="nt">-P</span> password.list smb://10.129.42.197

<span class="nv">$ </span>msf6 <span class="o">&gt;</span> use auxiliary/scanner/smb/smb_login
</code></pre></div></div>

<h2 id="winrm">WinRM</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>crackmapexec winrm &lt;IP&gt; <span class="nt">-u</span> user.list <span class="nt">-p</span> password.list
</code></pre></div></div>

<h2 id="rdp">RDP</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>crowbar <span class="nt">-b</span> rdp <span class="nt">-s</span> 192.168.220.142/32 <span class="nt">-U</span> users.txt <span class="nt">-c</span> <span class="s1">'password123'</span>
<span class="nv">$ </span>hydra <span class="nt">-L</span> usernames.txt <span class="nt">-p</span> <span class="s1">'password123'</span> 192.168.2.143 rdp
<span class="nv">$ </span>hydra <span class="nt">-L</span> user.list <span class="nt">-P</span> password.list rdp://10.129.42.197<span class="sb">`</span>
</code></pre></div></div>

<hr />

<h1 id="login-attacks">Login Attacks</h1>
<h2 id="default-passwords-1">Default Passwords</h2>
<p><code class="language-plaintext highlighter-rouge">/usr/share/wordlists/seclists/Passwords/Default-Credentials</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-C</span> /usr/share/wordlists/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt &lt;IP&gt; <span class="nt">-s</span> &lt;PORT&gt; http-get /
</code></pre></div></div>

<h2 id="usernamepassword-attack">Username/Password Attack</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-L</span> /usr/share/wordlists/secLists/Usernames/Names/names.txt <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt <span class="nt">-u</span> <span class="nt">-f</span> &lt;IP&gt; <span class="nt">-s</span> &lt;PORT&gt; http-get /
</code></pre></div></div>

<h2 id="username-brute-force">Username Brute Force</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-L</span> /usr/share/wordlists/secLists/Usernames/Names/names.txt <span class="nt">-p</span> &lt;PASSWORD&gt; <span class="nt">-u</span> <span class="nt">-f</span> &lt;IP&gt; <span class="nt">-s</span> &lt;PORT&gt; http-get /
</code></pre></div></div>

<h2 id="brute-forcing-forms">Brute Forcing Forms</h2>
<p>two types of http modules interesting for us:</p>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>http[s]-{head</td>
          <td>get</td>
          <td>post}</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>http[s]-post-form
The 1st module serves for basic HTTP authentication, while the 2nd module is used for login forms, like .php or .aspx and others.</li>
</ul>

<p>To decide which module we need, we have to determine whether the web application uses GET or a POST form. We can test it by trying to log in and pay attention to the URL. If we recognize that any of our input was pasted into the URL, the web application uses a GET form. Otherwise, it uses a POST form.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>hydra <span class="nt">-l</span> &lt;admin&gt; <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt <span class="nt">-f</span> &lt;IP&gt; <span class="nt">-s</span> &lt;PORT&gt; http-post-form <span class="s2">"/login.php:username=^USER^&amp;password=^PASS^:F=&lt;form name='login'"</span>
</code></pre></div></div>

<ul>
  <li>login.php: url</li>
  <li>username=^USER^&amp;password=^PASS^: parameters to POST (Capture on Burp Suite)</li>
  <li>Third: form name (Check source code)</li>
</ul>

<h1 id="protected-files">Protected Files</h1>
<h2 id="cracking-with-john">Cracking with John</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>locate <span class="k">*</span>2john<span class="k">*</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh2john.py SSH.private <span class="o">&gt;</span> ssh.hash
</code></pre></div></div>

<h2 id="cracking-openssl-encrypted-archives">Cracking OpenSSL Encrypted Archives</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file GZIP.gzip 

GZIP.gzip: openssl enc<span class="s1">'d data with salted password
</span></code></pre></div></div>

<h3 id="using-a-for-loop-to-display-extracted-contents">Using a for-loop to Display Extracted Contents</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">cat </span>rockyou.txt<span class="si">)</span><span class="p">;</span><span class="k">do </span>openssl enc <span class="nt">-aes-256-cbc</span> <span class="nt">-d</span> <span class="nt">-in</span> GZIP.gzip <span class="nt">-k</span> <span class="nv">$i</span> 2&gt;/dev/null| <span class="nb">tar </span>xz<span class="p">;</span><span class="k">done</span>
</code></pre></div></div>

      </section>
    </div>
  </body>
</html>
