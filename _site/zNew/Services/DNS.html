<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pentest CheatSheet | Pentest CheatSheet</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Pentest CheatSheet" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Pentest CheatSheet" />
<meta property="og:description" content="Pentest CheatSheet" />
<link rel="canonical" href="http://localhost:4000/zNew/Services/DNS.html" />
<meta property="og:url" content="http://localhost:4000/zNew/Services/DNS.html" />
<meta property="og:site_name" content="Pentest CheatSheet" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pentest CheatSheet" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Pentest CheatSheet","headline":"Pentest CheatSheet","url":"http://localhost:4000/zNew/Services/DNS.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>Pentest CheatSheet</h1>
        </a>
        <h2>Pentest CheatSheet</h2>

        <section id="downloads">
          
          <a href="" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="footprinting">Footprinting</h1>
<h2 id="nmap">Nmap</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nmap <span class="nt">-p53</span> <span class="nt">-Pn</span> <span class="nt">-sV</span> <span class="nt">-sC</span> 10.10.110.213
</code></pre></div></div>

<h2 id="dig">Dig</h2>
<p>| DNS Record | Description |
|————|————-|
| A          | Returns an IPv4 address of the requested domain as a result. |
| AAAA       | Returns an IPv6 address of the requested domain. |
| MX         | Returns the responsible mail servers as a result. |
| NS         | Returns the DNS servers (nameservers) of the domain. |
| TXT        | This record can contain various information. The all-rounder can be used, e.g., to validate the Google Search Console or validate SSL certificates. In addition, SPF and DMARC entries are set to validate mail traffic and protect it from spam. |
| CNAME      | This record serves as an alias for another domain name. If you want the domain www.hackthebox.eu to point to the same IP as hackthebox.eu, you would create an A record for hackthebox.eu and a CNAME record for www.hackthebox.eu. |
| PTR        | The PTR record works the other way around (reverse lookup). It converts IP addresses into valid domain names. |
| SOA        | Provides information about the corresponding DNS zone and email address of the administrative contact. |</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># DIG - NS Query</span>
<span class="nv">$ </span>dig ns inlanefreight.htb @&lt;IP&gt;

<span class="c"># DIG - Version Query</span>
<span class="nv">$ </span>dig CH TXT version.bind 10.129.120.85

<span class="c"># DIG - ANY Query</span>
<span class="nv">$ </span>dig any inlanefreight.htb @&lt;IP&gt;

<span class="c"># DIG - AXFR Zone Transfer</span>
<span class="nv">$ </span>dig axfr inlanefreight.htb @&lt;IP&gt;
</code></pre></div></div>

<p>We dig axfr and see what returns. 
If nothing returns, brute force.</p>

<h2 id="subdomain-brute-forcing">Subdomain Brute Forcing</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="k">for </span>sub <span class="k">in</span> <span class="si">$(</span><span class="nb">cat</span> /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-110000.txt<span class="si">)</span><span class="p">;</span><span class="k">do </span>dig <span class="nv">$sub</span>.inlanefreight.htb @&lt;IP&gt; | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">';\|SOA'</span> | <span class="nb">sed</span> <span class="nt">-r</span> <span class="s1">'/^\s*$/d'</span> | <span class="nb">grep</span> <span class="nv">$sub</span> | <span class="nb">tee</span> <span class="nt">-a</span> subdomains.txt<span class="p">;</span><span class="k">done</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dnsenum <span class="nt">--dnsserver</span> &lt;IP&gt; <span class="nt">--enum</span> <span class="nt">-p</span> 0 <span class="nt">-s</span> 0 <span class="nt">-o</span> subdomains.txt <span class="nt">-f</span> usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt/fierce.txt inlanefreight.htb
</code></pre></div></div>

<h2 id="attacking-dns">Attacking DNS</h2>
<h3 id="dig---axfr-zone-transfer">DIG - AXFR Zone Transfer</h3>

<p>COR33@htb[/htb]# dig AXFR @ns1.inlanefreight.htb inlanefreight.htb</p>

<h3 id="domain-takeovers--subdomain-enumeration">Domain Takeovers &amp; Subdomain Enumeration</h3>
<p>COR33@htb[/htb]# ./subfinder -d inlanefreight.com -v</p>

<p>COR33@htb[/htb]$ cd subbrute
COR33@htb[/htb]$ echo “ns1.inlanefreight.com” &gt; ./resolvers.txt
COR33@htb[/htb]$ ./subbrute inlanefreight.com -s ./names.txt -r ./resolvers.txt</p>

      </section>
    </div>
  </body>
</html>
