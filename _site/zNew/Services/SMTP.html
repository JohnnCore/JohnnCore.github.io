<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/style.css?v=">

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pentest CheatSheet | Pentest CheatSheet</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Pentest CheatSheet" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Pentest CheatSheet" />
<meta property="og:description" content="Pentest CheatSheet" />
<link rel="canonical" href="http://localhost:4000/zNew/Services/SMTP.html" />
<meta property="og:url" content="http://localhost:4000/zNew/Services/SMTP.html" />
<meta property="og:site_name" content="Pentest CheatSheet" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pentest CheatSheet" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Pentest CheatSheet","headline":"Pentest CheatSheet","url":"http://localhost:4000/zNew/Services/SMTP.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>Pentest CheatSheet</h1>
        </a>
        <h2>Pentest CheatSheet</h2>

        <section id="downloads">
          
          <a href="" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="interacting">Interacting</h1>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>telnet 10.129.14.128 25
</code></pre></div></div>

<h2 id="send-an-email">Send an Email</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>telnet 10.129.14.128 25

Trying 10.129.14.128...
Connected to 10.129.14.128.
Escape character is <span class="s1">'^]'</span><span class="nb">.</span>
220 ESMTP Server


EHLO inlanefreight.htb

250-mail1.inlanefreight.htb
250-PIPELINING
250-SIZE 10240000
250-ETRN
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250-SMTPUTF8
250 CHUNKING


MAIL FROM: &lt;cry0l1t3@inlanefreight.htb&gt;

250 2.1.0 Ok


RCPT TO: &lt;mrb3n@inlanefreight.htb&gt; <span class="nv">NOTIFY</span><span class="o">=</span>success,failure

250 2.1.5 Ok


DATA

354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;

From: &lt;cry0l1t3@inlanefreight.htb&gt;
To: &lt;mrb3n@inlanefreight.htb&gt;
Subject: DB
Date: Tue, 28 Sept 2021 16:32:51 +0200
Hey man, I am trying to access our XY-DB but the creds don<span class="s1">'t work. 
Did you make any changes there?
.

250 2.0.0 Ok: queued as 6E1CF1681AB


QUIT

221 2.0.0 Bye
Connection closed by foreign host.
</span></code></pre></div></div>

<h1 id="footprinting-the-service">Footprinting the Service</h1>
<h2 id="nmap">Nmap</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>nmap &lt;IP&gt; <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p25</span><span class="sb">`</span>
</code></pre></div></div>

<h2 id="nmap---open-relay">Nmap - Open Relay</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>nmap &lt;IP&gt; <span class="nt">-p25</span> <span class="nt">--script</span> smtp-open-relay <span class="nt">-v</span><span class="sb">`</span>
</code></pre></div></div>

<h2 id="attacking-email-services">Attacking Email Services</h2>
<h3 id="host---mx-records">Host - MX Records</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>host <span class="nt">-t</span> MX hackthebox.eu
</code></pre></div></div>

<h3 id="dig---mx-records">DIG - MX Records</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dig mx inlanefreight.com | <span class="nb">grep</span> <span class="s2">"MX"</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">";"</span>
</code></pre></div></div>

<h3 id="host---a-records">Host - A Records</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COR33@htb[/htb]$ host -t A mail1.inlanefreight.htb.
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COR33@htb[/htb]$ smtp-user-enum -M RCPT -U userlist.txt -D inlanefreight.htb -t 10.129.203.7
</code></pre></div></div>

<h3 id="o365-spray">O365 Spray</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COR33@htb[/htb]$ python3 o365spray.py --validate --domain msplaintext.xyz
</code></pre></div></div>

<p>Now, we can attempt to identify usernames.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COR33@htb[/htb]$ python3 o365spray.py --enum -U users.txt --domain msplaintext.xyz        
</code></pre></div></div>

<h2 id="password-attacks">Password Attacks</h2>
<h3 id="hydra---password-attack">Hydra - Password Attack</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COR33@htb[/htb]$ hydra -L users.txt -p 'Company01!' -f 10.10.110.20 pop3
</code></pre></div></div>

<h3 id="o365-spray---password-spraying">O365 Spray - Password Spraying</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COR33@htb[/htb]$ python3 o365spray.py --spray -U usersfound.txt -p 'March2022!' --count 1 --lockout 1 --domain msplaintext.xyz
</code></pre></div></div>

      </section>
    </div>
  </body>
</html>
